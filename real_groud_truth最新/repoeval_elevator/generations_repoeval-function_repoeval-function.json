[["```\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u95e8\u64cd\u4f5c\u5b9a\u65f6\u5668\n\tbDoorOpening\t\t:\tBOOL;\t\t// \u95e8\u6b63\u5728\u6253\u5f00\n\tbDoorClosing\t\t:\tBOOL;\t\t// \u95e8\u6b63\u5728\u5173\u95ed\nEND_VAR\n\n// \u95e8\u63a7\u5236\u903b\u8f91\nIF bArrivedAtTarget THEN\n\t// \u5982\u679c\u5230\u8fbe\u76ee\u6807\u697c\u5c42\uff0c\u4e14\u95e8\u672a\u6253\u5f00\uff0c\u5219\u53d1\u9001\u5f00\u95e8\u547d\u4ee4\n\tIF NOT bDoorOpen THEN\n\t\tbOpenDoor := TRUE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorOpening := TRUE;\n\t\tbDoorClosing := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#5S); // \u5f00\u95e8\u5ef6\u65f6\n\tEND_IF\nELSE\n\t// \u5982\u679c\u672a\u5230\u8fbe\u76ee\u6807\u697c\u5c42\uff0c\u4e14\u95e8\u5df2\u6253\u5f00\uff0c\u5219\u53d1\u9001\u5173\u95e8\u547d\u4ee4\n\tIF bDoorOpen THEN\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n\t\tbDoorOpening := FALSE;\n\t\tbDoorClosing := TRUE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#5S); // \u5173\u95e8\u5ef6\u65f6\n\tEND_IF\nEND_IF\n\n// \u5b9a\u65f6\u5668\u5b8c\u6210\u540e\u66f4\u65b0\u95e8\u72b6\u6001\nIF fbDoorTimer.Q THEN\n\tIF bDoorOpening THEN\n\t\tbDoorOpen := TRUE;\n\t\tbDoorReady := TRUE; // \u95e8\u51c6\u5907\u597d\uff0c\u7535\u68af\u53ef\u4ee5\u79fb\u52a8\n\t\tbDoorOpening := FALSE;\n\tELSEIF bDoorClosing THEN\n\t\tbDoorOpen := FALSE;\n\t\tbDoorReady := FALSE; // \u95e8\u672a\u51c6\u5907\u597d\uff0c\u7535\u68af\u4e0d\u80fd\u79fb\u52a8\n\t\tbDoorClosing := FALSE;\n\tEND_IF\n\tfbDoorTimer(IN := FALSE); // \u505c\u6b62\u5b9a\u65f6\u5668\nEND_IF\n```"], ["```\nVAR\n\tnTargetFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u76ee\u6807\u697c\u5c42\n\tnState\t\t\t\t:\tINT;\t\t\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbMovingUp := FALSE;\n\t\tbMovingDown := FALSE;\n\t\tbArrivedAtTarget := FALSE;\n\n\t\t// \u68c0\u67e5\u662f\u5426\u6709\u76ee\u6807\u697c\u5c42\n\t\tFOR i := 0 TO 3 DO\n\t\t\tIF TargetFloors[i] THEN\n\t\t\t\tnTargetFloor := i;\n\t\t\t\tnState := 1; // \u5f00\u59cb\u79fb\u52a8\u6d41\u7a0b\n\t\t\t\tEXIT;\n\t\t\tEND_IF\n\t\tEND_FOR\n\n\t1: // \u79fb\u52a8\u5230\u76ee\u6807\u697c\u5c42\n\t\tIF CurrentFloor < nTargetFloor THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\tELSIF CurrentFloor > nTargetFloor THEN\n\t\t\tbMovingUp := FALSE;\n\t\t\tbMovingDown := TRUE;\n\t\tELSE\n\t\t\tbMovingUp := FALSE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tbArrivedAtTarget := TRUE;\n\t\t\tTargetFloors[nTargetFloor] := FALSE; // \u6e05\u9664\u76ee\u6807\u697c\u5c42\n\t\t\tnState := 2; // \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\t\tEND_IF\n\n\t2: // \u7b49\u5f85\u95e8\u51c6\u5907\u597d\n\t\tIF bDoorReady THEN\n\t\t\tnState := 0; // \u8fd4\u56de\u7a7a\u95f2\u72b6\u6001\n\t\tEND_IF\nEND_CASE\n```"], ["```\nVAR_OUTPUT\n\tDetectedFloor\t:\tINT;\t\t// \u68c0\u6d4b\u5230\u7684\u697c\u5c42\nEND_VAR\n\n// \u68c0\u6d4b\u5f53\u524d\u697c\u5c42\nIF FloorSensor0 THEN\n\tDetectedFloor := 0;\nELSIF FloorSensor1 THEN\n\tDetectedFloor := 1;\nELSIF FloorSensor2 THEN\n\tDetectedFloor := 2;\nELSIF FloorSensor3 THEN\n\tDetectedFloor := 3;\nELSE\n\tDetectedFloor := CurrentFloor; // \u5982\u679c\u6ca1\u6709\u4f20\u611f\u5668\u89e6\u53d1\uff0c\u4fdd\u6301\u5f53\u524d\u697c\u5c42\nEND_IF\n\nRETURN DetectedFloor;\nEND_FUNCTION\n\n// --------------------------------------------------\n// Continue PLC_PRG logic\n// --------------------------------------------------\n\n// \u66f4\u65b0\u5f53\u524d\u697c\u5c42\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== \u547c\u53eb\u5904\u7406 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== \u95e8\u63a7\u5236\u903b\u8f91 ==========\nfbDoorController(\n\tbArrivedAtTarget := TargetFloors[CurrentFloor],\n\tbDoorClosed := DoorClosed\n);\nOpenDoor := fbDoorController.OpenDoor;\nCloseDoor := fbDoorController.CloseDoor;\n\n// ========== \u7535\u68af\u79fb\u52a8\u903b\u8f91 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := DoorClosed,\n\tTargetFloors := TargetFloors\n);\n\n// \u52a8\u753b\u66f4\u65b0\naniDoor0 := fbDoorController.aniDoor0;\naniDoor1 := fbDoorController.aniDoor1;\naniDoor2 := fbDoorController.aniDoor2;\naniDoor3 := fbDoorController.aniDoor3;\n\n// END PROGRAM PLC_PRG\n```"], ["``` \nVAR\n\ti\t\t\t\t:\tINT;\t\t// \u5faa\u73af\u53d8\u91cf\nEND_VAR\n\n// \u5c06\u547c\u53eb\u4fe1\u53f7\u6ce8\u518c\u5230\u76ee\u6807\u697c\u5c42\u6570\u7ec4\u4e2d\nIF CallGround THEN\n\tTargetFloors[0] := TRUE;\nEND_IF;\n\nIF CallFloor1 THEN\n\tTargetFloors[1] := TRUE;\nEND_IF;\n\nIF CallFloor2 THEN\n\tTargetFloors[2] := TRUE;\nEND_IF;\n\nIF CallFloor3 THEN\n\tTargetFloors[3] := TRUE;\nEND_IF;\n\n// \u786e\u4fdd\u76ee\u6807\u697c\u5c42\u6570\u7ec4\u7684\u72b6\u6001\u6b63\u786e\nFOR i := 0 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\t// \u76ee\u6807\u697c\u5c42\u5df2\u88ab\u6ce8\u518c\n\t\t// \u53ef\u5728\u6b64\u5904\u6dfb\u52a0\u8c03\u8bd5\u6216\u65e5\u5fd7\u8bb0\u5f55\u4ee3\u7801\n\tEND_IF;\nEND_FOR;\nEND_FUNCTION\n```"], ["```\nVAR_OUTPUT\n\tnUpdatedAni\t\t:\tDINT;\t\t// \u66f4\u65b0\u540e\u7684\u52a8\u753b\u503c\nEND_VAR\nVAR\n\tnStep\t\t\t:\tDINT := 5;\t// \u52a8\u753b\u6b65\u957f\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u9700\u8981\u5f00\u95e8\u52a8\u753b\nIF bOpenDoor THEN\n\tIF nCurrentAni < nMaxAni THEN\n\t\tnUpdatedAni := nCurrentAni + nStep; // \u589e\u52a0\u52a8\u753b\u503c\n\tELSE\n\t\tnUpdatedAni := nMaxAni; // \u8fbe\u5230\u6700\u5927\u52a8\u753b\u503c\n\tEND_IF;\nELSIF bCloseDoor THEN\n\tIF nCurrentAni > 0 THEN\n\t\tnUpdatedAni := nCurrentAni - nStep; // \u51cf\u5c11\u52a8\u753b\u503c\n\tELSE\n\t\tnUpdatedAni := 0; // \u8fbe\u5230\u6700\u5c0f\u52a8\u753b\u503c\n\tEND_IF;\nELSE\n\t// \u5982\u679c\u6ca1\u6709\u5f00\u95e8\u6216\u5173\u95e8\u547d\u4ee4\uff0c\u4fdd\u6301\u5f53\u524d\u52a8\u753b\u503c\n\tnUpdatedAni := nCurrentAni;\nEND_IF;\n\n// \u8fd4\u56de\u66f4\u65b0\u540e\u7684\u52a8\u753b\u503c\nRETURN nUpdatedAni;\n```"]]