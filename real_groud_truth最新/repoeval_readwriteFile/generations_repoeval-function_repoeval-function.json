[["```\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\treadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u53d6\u6570\u636e\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u8bfb\u53d6\u6210\u529f\n\tbBusy\t:\tBOOL;//\u8bfb\u53d6\u5fd9\n\tbErr\t:\tBOOL;//\u8bfb\u53d6\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\n\treadData\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u53d6\u7684\u6570\u636e\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF;\n\n\t1:\n\t\t// \u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := FileOpen(fileName := fileName, mode := 'READ');\n\t\tIF fileHandle = 0 THEN\n\t\t\tbErr := TRUE;\n\t\t\tnErrId := 1; // \u6587\u4ef6\u6253\u5f00\u5931\u8d25\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\tELSE\n\t\t\tnState := 2;\n\t\tEND_IF;\n\n\t2:\n\t\t// \u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\n\t\tnNumRead := FileRead(fileHandle := fileHandle, buffer := readBuffer, size := SIZEOF(readBuffer));\n\t\tIF nNumRead = 0 THEN\n\t\t\tbErr := TRUE;\n\t\t\tnErrId := 2; // \u6587\u4ef6\u8bfb\u53d6\u5931\u8d25\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\tELSE\n\t\t\treadData := readBuffer; // \u5c06\u8bfb\u53d6\u7684\u6570\u636e\u5b58\u50a8\u5230\u8f93\u51fa\u53d8\u91cf\n\t\t\tnState := 3;\n\t\tEND_IF;\n\n\t3:\n\t\t// \u5173\u95ed\u6587\u4ef6\n\t\tIF FileClose(fileHandle := fileHandle) THEN\n\t\t\tbDone := TRUE;\n\t\t\tbBusy := FALSE;\n\t\t\tnState := 0;\n\t\tELSE\n\t\t\tbErr := TRUE;\n\t\t\tnErrId := 3; // \u6587\u4ef6\u5173\u95ed\u5931\u8d25\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\tEND_IF;\n\nELSE\n\tnState := 0;\nEND_CASE;\n```"], ["```\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t// \u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName, am := 'w');//\u4ee5\u5199\u6a21\u5f0f\u6253\u5f00\u6587\u4ef6\n\t\tIF fileHandle = 0 THEN\n\t\t\tnState := 99; // \u9519\u8bef\u72b6\u6001\n\t\t\tbErr := TRUE;\n\t\t\tnErrId := 1; // \u6587\u4ef6\u6253\u5f00\u5931\u8d25\n\t\tELSE\n\t\t\tnState := 2;\n\t\tEND_IF\n\t2:\n\t\t// \u5199\u5165\u6587\u4ef6\n\t\tIF SysFileWrite(hFile := fileHandle, pBuffer := ADR(writeBuffer), szSize := writeNum) THEN\n\t\t\tnState := 3;\n\t\tELSE\n\t\t\tnState := 99; // \u9519\u8bef\u72b6\u6001\n\t\t\tbErr := TRUE;\n\t\t\tnErrId := 2; // \u5199\u5165\u5931\u8d25\n\t\tEND_IF\n\t3:\n\t\t// \u5173\u95ed\u6587\u4ef6\n\t\tIF SysFileClose(hFile := fileHandle) THEN\n\t\t\tnState := 4;\n\t\tELSE\n\t\t\tnState := 99; // \u9519\u8bef\u72b6\u6001\n\t\t\tbErr := TRUE;\n\t\t\tnErrId := 3; // \u6587\u4ef6\u5173\u95ed\u5931\u8d25\n\t\tEND_IF\n\t4:\n\t\t// \u5199\u5165\u5b8c\u6210\n\t\tbDone := TRUE;\n\t\tbBusy := FALSE;\n\t\tnState := 0; // \u91cd\u7f6e\u72b6\u6001\n\t99:\n\t\t// \u9519\u8bef\u5904\u7406\n\t\tbBusy := FALSE;\n\tEND_CASE\nEND_FUNCTION_BLOCK\n```"]]