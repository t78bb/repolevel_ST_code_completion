{
  "library": "CommFB",
  "title": "RDIAG (FunctionBlock)",
  "url": "https://content.helpme-codesys.com/en/libs/CommFB/Current/CommFB/RDIAG.html",
  "page_title": "RDIAG (FB)",
  "text": "CommFB\nAINFO_TYPE (Union)\nAddressConcept (GVL)\nAddress Concept\nGenerating a CommFB-ID\nProfibus DP\nProfinet IO\nDevice Diagnosis\nAddress Conversion\nAddresses\nADDR_TO_ID (FunctionBlock)\nADDR_TYPE (Union)\nCREATE_ID (FunctionBlock)\nDP_ADDR (Struct)\nDP_DEVICE_ID (Struct)\nID_TO_ADDR (FunctionBlock)\nIO_SYSTEM_TYPE (Enum)\nPN_ADDR (Struct)\nPN_DEVICE_ID (Struct)\nSUBSLOT_ID (Function)\nCNCT (FunctionBlock)\nConstants (GVL)\nDP Address\nADDR (Function)\nID (Function)\nSLOT_ID (Function)\nDP_AINFO (Struct)\nDP_DIAG (Struct)\nErrorCode (Enum)\nErrorCode1_RW (Enum)\nFieldDevice\nPRVREC (FunctionBlock)\nPRVREC_MODE (Enum)\nRCVREC (FunctionBlock)\nRCVREC_MODE (Enum)\nSALARM (FunctionBlock)\nGETIO_PART (FunctionBlock)\nPN_AINFO (Struct)\nRALARM (FunctionBlock)\nRALARM_MODE (Enum)\nRDIAG (FunctionBlock)\nRDREC (FunctionBlock)\nSETIO_PART (FunctionBlock)\nWRREC (FunctionBlock)\nImages\nLibrary Information\nGetLibVersion (Function)\nGetLibVersionNumber (Function)\nIsLibReleased (Function)\nFile and Project Information\nLibrary Reference\nIoDriver Profibus2 Interfaces\nLibrary Identification\nLibrary Properties\nSysMem\nLibrary Identification\nLibrary Properties\nCommFB\nDocs\n»\nCommFB\n»\nRDIAG (FB)\nRDIAG (FB)\nÂ¶\nFUNCTION_BLOCK RDIAG\nRead Diagnosis data from DP Slave.\nThis service is for Profibus only, Profinet uses a different, more advanced Diagnosis.\nCode-Example: Profibus DP Diagnosis\nPROGRAM\nPLC_PRG\nVAR\nreadDiag\n:\nCommfB.RDIAG\n;\ndiag\n:\nCommFB.DP_DIAG\n;\nsMessage\n:\nSTRING\n;\nEND_VAR\nreadDiag.REQ\n:=\nTRUE\n;\nreadDiag.ID\n:=\nCommFB.ID\n(\nEN\n:=\nTRUE\n,\nMaster\n:=\nCIFX_PB.MasterID\n,\nSEGMENT\n:=\n0\n,\nSTATION\n:=\n3\n,\nSLOT\n:=\n0\n);\nreadDiag.MLEN\n:=\nTO_INT\n(\nSIZEOF\n(\ndiag\n));\nreadDiag\n(\nDINFO\n:=\ndiag\n);\nIF\n(\nreadDiag.VALID\n)\nTHEN\nIF\n(\ndiag.status1.Diag.Station_Non_Existent\n)\nTHEN\nsMessage\n:=\n'Station with Address = 3 is not available !'\n;\nEND_IF\nEND_IF\nInOut:\nScope\nName\nType\nComment\nInput\nREQ\nBOOL\nRequest\nID\nDWORD\nIdentifier of a of DP-slave (see:\nAddressConcept\n)\nMLEN\nINT\nmaximum length to be read\nOutput\nVALID\nBOOL\nNew diagnosis data received and is valid\nBUSY\nBOOL\nFB is busy\nERROR\nBOOL\nError detected\nSTATUS\nDWORD\nLast detected status\nLEN\nINT\nLength of diagnosis data\nInout\nDINFO\nDP_DIAG\nRead diagnosis data (see:\nDP_DIAG",
  "tables": [
    {
      "headers": [
        "Scope",
        "Name",
        "Type",
        "Comment"
      ],
      "rows": [
        {
          "Scope": "Input",
          "Name": "REQ",
          "Type": "BOOL",
          "Comment": "Request"
        },
        [
          "ID",
          "DWORD",
          "Identifier of a of DP-slave (see:AddressConcept)"
        ],
        [
          "MLEN",
          "INT",
          "maximum length to be read"
        ],
        {
          "Scope": "Output",
          "Name": "VALID",
          "Type": "BOOL",
          "Comment": "New diagnosis data received and is valid"
        },
        [
          "BUSY",
          "BOOL",
          "FB is busy"
        ],
        [
          "ERROR",
          "BOOL",
          "Error detected"
        ],
        [
          "STATUS",
          "DWORD",
          "Last detected status"
        ],
        [
          "LEN",
          "INT",
          "Length of diagnosis data"
        ],
        {
          "Scope": "Inout",
          "Name": "DINFO",
          "Type": "DP_DIAG",
          "Comment": "Read diagnosis data (see:DP_DIAG"
        }
      ]
    }
  ]
}