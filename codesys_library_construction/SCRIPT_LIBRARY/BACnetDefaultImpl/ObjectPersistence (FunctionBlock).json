{
  "library": "BACnetDefaultImpl",
  "title": "ObjectPersistence (FunctionBlock)",
  "url": "https://content.helpme-codesys.com/en/libs/BACnetDefaultImpl/Current/BACnetDefaultImpl/Function-Blocks/ObjectPersistence.html",
  "page_title": "ObjectPersistence (FB)",
  "text": "\nFUNCTION_BLOCK ObjectPersistence EXTENDS BACnet.BACnetServerPluginBase IMPLEMENTS CmpEventMgr.ICmpEventCallback, BACnet.IBACnetPersistence\nDefault implementation of object persistence.\nIt stores selected properties of objects in one binary data file per object and maintains an index file for bookkeeping.\nThe naming convention for the object persistence file is: pdata_{deviceId}_{objectType}_{objectInstanceNumber}.dat\nto ensures to identify and restore object information for an object matching the tuple {deviceId},{objectType},{objectInstanceNumber}.\nOptionally ObjectPersistence stores/restores objects which have create by client CreateObject-requests - this option is enabled by default.\nThis BACnet-Server-plugin needs to be registered prior to BACnetServer.StartBACnetStack() to ensure restore of objects from persistence during StartBACnetStack(),\nso you canât use it with BACnet-Server AutoStart (at application init).\nDuring restore non existent object files listed in the index file are ignored silently.\nThe user is in control where to place the persistence files - writing the ObjectPersistence.PersistentPath.\nThis helps to control when the persistence files are deleted.\nThe default for PersistentPath is â./bacnetbackupâ which keeps the persistence files at âReset Origin (Application)â (as well at âReset Warmâ and âReset Coldâ of course)\nbut deletes the persistence files at âReset Origin Deviceâ.\nIf it is required to delete the persistence files at âReset Origin (Application)â this could be achieved placing the persistence files\nunderneath the application:\npCurrentApplication := CmpApp.AppGetCurrent(ADR(result));\nobjectPersistence.PersistentPath := CONCAT(pCurrentApplication^.szName, â/bacnetbackupâ);\nPlacing the persistence files somewhere else leaves the control when to delete them completely at the application calling ObjectPersistence.DeleteAllData().\nThere are two options when to persist object information.\nThe recommended default option is to persist object information at graceful shutdown of BACnetServer - see BACnetServer.StopBACnetStack().\nA graceful shutdown of BACnetServer is done during graceful shutdown of the PLC if the PLC provides enough power reserve\nthrough an internal uninterruptible power supply (UPS).\nCmpApp.EVT_PrepareExit is used to trigger the graceful shutdown of BACnetServer during graceful shutdown of the PLC.\nSome PLCâs doesnt provides enough power reserve to do so, in this case a âhard shutdownâ might happen any time.\nIn this case the object information needs to be stored on demand calling DumpDatabase() prior to a sudden shutdown,\nbut a hard shutdown might happen in the middle of this action.\nSo all objects are stored to an object temp file first, last file to store is the index temp file.\nDone this the index temp file is copied to index file, and afterwards all object temp files are copied to object data files.\nIn case the index file or an object data file can not be read properly during restore,\nwe give it a try to read the according temp file instead.\nThe application can choose this option setting HardShutdown to TRUE prior to plugin registration.\nProperties:\nHardShutdown\nName\nPersistentPath\nRestoreClientCreatedObjects\nMethods:\nDeleteAllData\nDumpDataBase\nLogIndexFileContent\nPostUnregister\nPreRegister\nStructure:\nDeleteAllData (Method)\nDumpDataBase (Method)\nHardShutdown (Property)\nLogIndexFileContent (Method)\nName (Property)\nPersistentPath (Property)\nPostUnregister (Method)\nPreRegister (Method)\nRestoreClientCreatedObjects (Property)\ntop\nCODESYS Group | We\nsoftware\nAutomation.\nto software\n['sɒftwɛər]\ntransitive verb\n__softwared/softwaring\n: to develop software\n// to software automation: to develop software for automation purposes\nThe CODESYS Group is the manufacturer of CODESYS, the leading hardware-independent\n                                    IEC 61131-3 automation software for developing and engineering controller\n                                    applications.\nCODESYS® is a registered trademark.\nCODESYS GmbH\nA member of the CODESYS Group\nMemminger Straße 151, 87439 Kempten\nGermany\nTel.:\n+49-831-54031-0\ninfo@codesys.com\nLegal Notice\nPrivacy Policy\nLinkedIn\nYoutube\nRSS\nDownloads\nLogin\nCODESYS Store\n© 2022 CODESYS GmbH\n| A member of the CODESYS Group",
  "tables": []
}