{"prompt": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR", "reference": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // \u7b49\u5f85\u5f00\u59cb\u5173\u95e8\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // \u5f00\u59cb\u5173\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t4: // \u5173\u95e8\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n\t\tbDoorOpen := FALSE;\n\t\tfbCloseDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbCloseDoorTimer.Q AND bDoorClosed THEN\n\t\t\tfbCloseDoorTimer(IN := FALSE);\n\t\t\tnState := 0; // \u8fd4\u56de\u7a7a\u95f2\n\t\tEND_IF\nEND_CASE", "docs": [{"text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // \u7b49\u5f85\u5f00\u59cb\u5173\u95e8\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // \u5f00\u59cb\u5173\u95e8\u6d41\u7a0b\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // \u7b49\u5f85\u5f00\u59cb\u5173\u95e8\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // \u5f00\u59cb\u5173\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t4: // \u5173\u95e8\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "VAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // \u7b49\u5f85\u5f00\u59cb\u5173\u95e8\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // \u5f00\u59cb\u5173\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t4: // \u5173\u95e8\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n\t\tbDoorOpen := FALSE;\n\t\tfbCloseDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbCloseDoorTimer.Q AND bDoorClosed THEN\n\t\t\tfbCloseDoorTimer(IN := FALSE);\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}], "metadata": {"task_id": "elevator/0", "ground_truth": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // \u7b49\u5f85\u5f00\u59cb\u5173\u95e8\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // \u5f00\u59cb\u5173\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t4: // \u5173\u95e8\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n\t\tbDoorOpen := FALSE;\n\t\tfbCloseDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbCloseDoorTimer.Q AND bDoorClosed THEN\n\t\t\tfbCloseDoorTimer(IN := FALSE);\n\t\t\tnState := 0; // \u8fd4\u56de\u7a7a\u95f2\n\t\tEND_IF\nEND_CASE", "fpath_tuple": ["FUN", "FB_ElevatorDoorController.st"], "context_start_lineno": 0, "lineno": 12, "function_name": "FB_ElevatorDoorController"}}
{"prompt": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR", "reference": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u4f4e\u697c\u5c42\u7684\u8bf7\u6c42\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u79fb\u52a8\u903b\u8f91\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// \u5411\u4e0a\u79fb\u52a8\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// \u6ca1\u6709\u66f4\u9ad8\u8bf7\u6c42\uff0c\u6539\u53d8\u65b9\u5411\n\t\tbMovingUp := FALSE;\n\t\tIF bHasLowerRequest THEN\n\t\t\tbMovingDown := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSIF bMovingDown OR (NOT bMovingUp AND bHasLowerRequest) THEN\n\t// \u5411\u4e0b\u79fb\u52a8\n\tIF bHasLowerRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingDown := TRUE;\n\t\t\tbMovingUp := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// \u6ca1\u6709\u66f4\u4f4e\u8bf7\u6c42\uff0c\u6539\u53d8\u65b9\u5411\n\t\tbMovingDown := FALSE;\n\t\tIF bHasUpperRequest THEN\n\t\t\tbMovingUp := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSE\n\t// \u521d\u59cb\u72b6\u6001\uff0c\u9ed8\u8ba4\u5411\u4e0a\n\tIF bHasUpperRequest THEN\n\t\tbMovingUp := TRUE;\n\tELSIF bHasLowerRequest THEN\n\t\tbMovingDown := TRUE;\n\tEND_IF\nEND_IF", "docs": [{"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u4f4e\u697c\u5c42\u7684\u8bf7\u6c42\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "VAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u4f4e\u697c\u5c42\u7684\u8bf7\u6c42\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u79fb\u52a8\u903b\u8f91\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// \u95e8\u5df2\u5173\u95ed\u4f20\u611f\u5668\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // \u7b49\u5f85\u5f00\u59cb\u5173\u95e8\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // \u5f00\u59cb\u5173\u95e8\u6d41\u7a0b\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}], "metadata": {"task_id": "elevator/1", "ground_truth": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u4f4e\u697c\u5c42\u7684\u8bf7\u6c42\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u79fb\u52a8\u903b\u8f91\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// \u5411\u4e0a\u79fb\u52a8\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// \u6ca1\u6709\u66f4\u9ad8\u8bf7\u6c42\uff0c\u6539\u53d8\u65b9\u5411\n\t\tbMovingUp := FALSE;\n\t\tIF bHasLowerRequest THEN\n\t\t\tbMovingDown := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSIF bMovingDown OR (NOT bMovingUp AND bHasLowerRequest) THEN\n\t// \u5411\u4e0b\u79fb\u52a8\n\tIF bHasLowerRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingDown := TRUE;\n\t\t\tbMovingUp := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// \u6ca1\u6709\u66f4\u4f4e\u8bf7\u6c42\uff0c\u6539\u53d8\u65b9\u5411\n\t\tbMovingDown := FALSE;\n\t\tIF bHasUpperRequest THEN\n\t\t\tbMovingUp := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSE\n\t// \u521d\u59cb\u72b6\u6001\uff0c\u9ed8\u8ba4\u5411\u4e0a\n\tIF bHasUpperRequest THEN\n\t\tbMovingUp := TRUE;\n\tELSIF bHasLowerRequest THEN\n\t\tbMovingDown := TRUE;\n\tEND_IF\nEND_IF", "fpath_tuple": ["FUN", "FB_ElevatorMovement.st"], "context_start_lineno": 0, "lineno": 14, "function_name": "FB_ElevatorMovement"}}
{"prompt": "FUNCTION F_DetectCurrentFloor : INT\nVAR_INPUT\n\tFloorSensor0\t:\tBOOL;\t\t// 0\u697c\u4f20\u611f\u5668\n\tFloorSensor1\t:\tBOOL;\t\t// 1\u697c\u4f20\u611f\u5668\n\tFloorSensor2\t:\tBOOL;\t\t// 2\u697c\u4f20\u611f\u5668\n\tFloorSensor3\t:\tBOOL;\t\t// 3\u697c\u4f20\u611f\u5668\n\tCurrentFloor\t:\tINT;\t\t// \u5f53\u524d\u697c\u5c42\uff08\u7528\u4e8e\u4fdd\u6301\u72b6\u6001\uff09\nEND_VAR", "reference": "FUNCTION F_DetectCurrentFloor : INT\nVAR_INPUT\n\tFloorSensor0\t:\tBOOL;\t\t// 0\u697c\u4f20\u611f\u5668\n\tFloorSensor1\t:\tBOOL;\t\t// 1\u697c\u4f20\u611f\u5668\n\tFloorSensor2\t:\tBOOL;\t\t// 2\u697c\u4f20\u611f\u5668\n\tFloorSensor3\t:\tBOOL;\t\t// 3\u697c\u4f20\u611f\u5668\n\tCurrentFloor\t:\tINT;\t\t// \u5f53\u524d\u697c\u5c42\uff08\u7528\u4e8e\u4fdd\u6301\u72b6\u6001\uff09\nEND_VAR\n\n// \u6839\u636e\u4f20\u611f\u5668\u8f93\u5165\u786e\u5b9a\u5f53\u524d\u697c\u5c42\nIF FloorSensor0 THEN \n\tF_DetectCurrentFloor := 0;\nELSIF FloorSensor1 THEN \n\tF_DetectCurrentFloor := 1;\nELSIF FloorSensor2 THEN \n\tF_DetectCurrentFloor := 2;\nELSIF FloorSensor3 THEN \n\tF_DetectCurrentFloor := 3;\nELSE\n\t// \u6ca1\u6709\u4f20\u611f\u5668\u4fe1\u53f7\u65f6\uff0c\u4fdd\u6301\u5f53\u524d\u697c\u5c42\n\tF_DetectCurrentFloor := CurrentFloor;\nEND_IF", "docs": [{"text": "FUNCTION F_DetectCurrentFloor : INT\nVAR_INPUT\n\tFloorSensor0\t:\tBOOL;\t\t// 0\u697c\u4f20\u611f\u5668\n\tFloorSensor1\t:\tBOOL;\t\t// 1\u697c\u4f20\u611f\u5668\n\tFloorSensor2\t:\tBOOL;\t\t// 2\u697c\u4f20\u611f\u5668\n\tFloorSensor3\t:\tBOOL;\t\t// 3\u697c\u4f20\u611f\u5668\n\tCurrentFloor\t:\tINT;\t\t// \u5f53\u524d\u697c\u5c42\uff08\u7528\u4e8e\u4fdd\u6301\u72b6\u6001\uff09\nEND_VAR\n\n// \u6839\u636e\u4f20\u611f\u5668\u8f93\u5165\u786e\u5b9a\u5f53\u524d\u697c\u5c42\nIF FloorSensor0 THEN \n\tF_DetectCurrentFloor := 0;\nELSIF FloorSensor1 THEN \n\tF_DetectCurrentFloor := 1;\nELSIF FloorSensor2 THEN \n\tF_DetectCurrentFloor := 2;\nELSIF FloorSensor3 THEN \n\tF_DetectCurrentFloor := 3;\nELSE\n\t// \u6ca1\u6709\u4f20\u611f\u5668\u4fe1\u53f7\u65f6\uff0c\u4fdd\u6301\u5f53\u524d\u697c\u5c42\n\tF_DetectCurrentFloor := CurrentFloor;\nEND_IF\n\n", "title": "elevator-FUN\\F_DetectCurrentFloor.st"}, {"text": "FUNCTION F_RegisterCalls\nVAR_INPUT\n\tCallGround\t\t:\tBOOL;\t\t// 0\u697c\u547c\u53eb\n\tCallFloor1\t\t:\tBOOL;\t\t// 1\u697c\u547c\u53eb\n\tCallFloor2\t\t:\tBOOL;\t\t// 2\u697c\u547c\u53eb\n\tCallFloor3\t\t:\tBOOL;\t\t// 3\u697c\u547c\u53eb\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\n\n// \u6ce8\u518c\u5404\u697c\u5c42\u7684\u547c\u53eb\u8bf7\u6c42\nIF CallGround THEN \n\tTargetFloors[0] := TRUE; \nEND_IF\n\nIF CallFloor1 THEN \n\tTargetFloors[1] := TRUE; \nEND_IF\n\nIF CallFloor2 THEN \n\tTargetFloors[2] := TRUE; \nEND_IF\n\nIF CallFloor3 THEN \n\tTargetFloors[3] := TRUE; \nEND_IF\n\n", "title": "elevator-FUN\\F_RegisterCalls.st"}, {"text": "FUNCTION F_RegisterCalls\nVAR_INPUT\n\tCallGround\t\t:\tBOOL;\t\t// 0\u697c\u547c\u53eb\n\tCallFloor1\t\t:\tBOOL;\t\t// 1\u697c\u547c\u53eb\n\tCallFloor2\t\t:\tBOOL;\t\t// 2\u697c\u547c\u53eb\n\tCallFloor3\t\t:\tBOOL;\t\t// 3\u697c\u547c\u53eb\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\n\n// \u6ce8\u518c\u5404\u697c\u5c42\u7684\u547c\u53eb\u8bf7\u6c42\nIF CallGround THEN \n\tTargetFloors[0] := TRUE; \nEND_IF\n\nIF CallFloor1 THEN \n\tTargetFloors[1] := TRUE; \nEND_IF\n\nIF CallFloor2 THEN \n\tTargetFloors[2] := TRUE; \nEND_IF\n\nIF CallFloor3 THEN \n", "title": "elevator-FUN\\F_RegisterCalls.st"}, {"text": "PROGRAM PLC_PRG\nVAR\n\t// \u8f93\u5165\u4fe1\u53f7\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// \u8f93\u51fa\u4fe1\u53f7\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// \u5185\u90e8\u53d8\u91cf\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// \u4f7f\u7528\u91cd\u6784\u540e\u7684\u529f\u80fd\u5757\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// \u95e8\u63a7\u5236\u5668\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// \u79fb\u52a8\u63a7\u5236\u5668\n\t\n\t// \u95e8\u5f00\u5173\u52a8\u753b\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== \u7d27\u6025\u505c\u6b62\u5904\u7406 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// \u590d\u4f4d\u529f\u80fd\u5757\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== \u697c\u5c42\u68c0\u6d4b ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n", "title": "elevator-PRG\\PLC_PRG.st"}, {"text": "PROGRAM PLC_PRG\nVAR\n\t// \u8f93\u5165\u4fe1\u53f7\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// \u8f93\u51fa\u4fe1\u53f7\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// \u5185\u90e8\u53d8\u91cf\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// \u4f7f\u7528\u91cd\u6784\u540e\u7684\u529f\u80fd\u5757\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// \u95e8\u63a7\u5236\u5668\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// \u79fb\u52a8\u63a7\u5236\u5668\n\t\n\t// \u95e8\u5f00\u5173\u52a8\u753b\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== \u7d27\u6025\u505c\u6b62\u5904\u7406 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// \u590d\u4f4d\u529f\u80fd\u5757\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== \u697c\u5c42\u68c0\u6d4b ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== \u547c\u53eb\u6ce8\u518c ==========\nF_RegisterCalls(\n", "title": "elevator-PRG\\PLC_PRG.st"}, {"text": "PROGRAM PLC_PRG\nVAR\n\t// \u8f93\u5165\u4fe1\u53f7\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// \u8f93\u51fa\u4fe1\u53f7\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// \u5185\u90e8\u53d8\u91cf\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// \u4f7f\u7528\u91cd\u6784\u540e\u7684\u529f\u80fd\u5757\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// \u95e8\u63a7\u5236\u5668\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// \u79fb\u52a8\u63a7\u5236\u5668\n\t\n\t// \u95e8\u5f00\u5173\u52a8\u753b\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== \u7d27\u6025\u505c\u6b62\u5904\u7406 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// \u590d\u4f4d\u529f\u80fd\u5757\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== \u697c\u5c42\u68c0\u6d4b ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== \u547c\u53eb\u6ce8\u518c ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n", "title": "elevator-PRG\\PLC_PRG.st"}, {"text": "CurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== \u547c\u53eb\u6ce8\u518c ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== \u7535\u68af\u79fb\u52a8\u63a7\u5236 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== \u95e8\u63a7\u5236 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n// \u66f4\u65b0\u8f93\u51fa\nOpenDoor := fbDoorController.bOpenDoor;\nCloseDoor := fbDoorController.bCloseDoor;\n\n// ========== \u95e8\u52a8\u753b\u66f4\u65b0 ==========\naniDoor0 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallGround,\n\tnCurrentAni := aniDoor0,\n\tnMaxAni := 70\n);\n\naniDoor1 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor1,\n\tnCurrentAni := aniDoor1,\n\tnMaxAni := 70\n);\n", "title": "elevator-PRG\\PLC_PRG.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u4f4e\u697c\u5c42\u7684\u8bf7\u6c42\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}], "metadata": {"task_id": "elevator/2", "ground_truth": "FUNCTION F_DetectCurrentFloor : INT\nVAR_INPUT\n\tFloorSensor0\t:\tBOOL;\t\t// 0\u697c\u4f20\u611f\u5668\n\tFloorSensor1\t:\tBOOL;\t\t// 1\u697c\u4f20\u611f\u5668\n\tFloorSensor2\t:\tBOOL;\t\t// 2\u697c\u4f20\u611f\u5668\n\tFloorSensor3\t:\tBOOL;\t\t// 3\u697c\u4f20\u611f\u5668\n\tCurrentFloor\t:\tINT;\t\t// \u5f53\u524d\u697c\u5c42\uff08\u7528\u4e8e\u4fdd\u6301\u72b6\u6001\uff09\nEND_VAR\n\n// \u6839\u636e\u4f20\u611f\u5668\u8f93\u5165\u786e\u5b9a\u5f53\u524d\u697c\u5c42\nIF FloorSensor0 THEN \n\tF_DetectCurrentFloor := 0;\nELSIF FloorSensor1 THEN \n\tF_DetectCurrentFloor := 1;\nELSIF FloorSensor2 THEN \n\tF_DetectCurrentFloor := 2;\nELSIF FloorSensor3 THEN \n\tF_DetectCurrentFloor := 3;\nELSE\n\t// \u6ca1\u6709\u4f20\u611f\u5668\u4fe1\u53f7\u65f6\uff0c\u4fdd\u6301\u5f53\u524d\u697c\u5c42\n\tF_DetectCurrentFloor := CurrentFloor;\nEND_IF", "fpath_tuple": ["FUN", "F_DetectCurrentFloor.st"], "context_start_lineno": 0, "lineno": 9, "function_name": "F_DetectCurrentFloor"}}
{"prompt": "FUNCTION F_RegisterCalls\nVAR_INPUT\n\tCallGround\t\t:\tBOOL;\t\t// 0\u697c\u547c\u53eb\n\tCallFloor1\t\t:\tBOOL;\t\t// 1\u697c\u547c\u53eb\n\tCallFloor2\t\t:\tBOOL;\t\t// 2\u697c\u547c\u53eb\n\tCallFloor3\t\t:\tBOOL;\t\t// 3\u697c\u547c\u53eb\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR", "reference": "FUNCTION F_RegisterCalls\nVAR_INPUT\n\tCallGround\t\t:\tBOOL;\t\t// 0\u697c\u547c\u53eb\n\tCallFloor1\t\t:\tBOOL;\t\t// 1\u697c\u547c\u53eb\n\tCallFloor2\t\t:\tBOOL;\t\t// 2\u697c\u547c\u53eb\n\tCallFloor3\t\t:\tBOOL;\t\t// 3\u697c\u547c\u53eb\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\n\n// \u6ce8\u518c\u5404\u697c\u5c42\u7684\u547c\u53eb\u8bf7\u6c42\nIF CallGround THEN \n\tTargetFloors[0] := TRUE; \nEND_IF\n\nIF CallFloor1 THEN \n\tTargetFloors[1] := TRUE; \nEND_IF\n\nIF CallFloor2 THEN \n\tTargetFloors[2] := TRUE; \nEND_IF\n\nIF CallFloor3 THEN \n\tTargetFloors[3] := TRUE; \nEND_IF", "docs": [{"text": "FUNCTION F_RegisterCalls\nVAR_INPUT\n\tCallGround\t\t:\tBOOL;\t\t// 0\u697c\u547c\u53eb\n\tCallFloor1\t\t:\tBOOL;\t\t// 1\u697c\u547c\u53eb\n\tCallFloor2\t\t:\tBOOL;\t\t// 2\u697c\u547c\u53eb\n\tCallFloor3\t\t:\tBOOL;\t\t// 3\u697c\u547c\u53eb\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\n\n// \u6ce8\u518c\u5404\u697c\u5c42\u7684\u547c\u53eb\u8bf7\u6c42\nIF CallGround THEN \n\tTargetFloors[0] := TRUE; \nEND_IF\n\nIF CallFloor1 THEN \n\tTargetFloors[1] := TRUE; \nEND_IF\n\nIF CallFloor2 THEN \n\tTargetFloors[2] := TRUE; \nEND_IF\n\nIF CallFloor3 THEN \n", "title": "elevator-FUN\\F_RegisterCalls.st"}, {"text": "FUNCTION F_RegisterCalls\nVAR_INPUT\n\tCallGround\t\t:\tBOOL;\t\t// 0\u697c\u547c\u53eb\n\tCallFloor1\t\t:\tBOOL;\t\t// 1\u697c\u547c\u53eb\n\tCallFloor2\t\t:\tBOOL;\t\t// 2\u697c\u547c\u53eb\n\tCallFloor3\t\t:\tBOOL;\t\t// 3\u697c\u547c\u53eb\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\n\n// \u6ce8\u518c\u5404\u697c\u5c42\u7684\u547c\u53eb\u8bf7\u6c42\nIF CallGround THEN \n\tTargetFloors[0] := TRUE; \nEND_IF\n\nIF CallFloor1 THEN \n\tTargetFloors[1] := TRUE; \nEND_IF\n\nIF CallFloor2 THEN \n\tTargetFloors[2] := TRUE; \nEND_IF\n\nIF CallFloor3 THEN \n\tTargetFloors[3] := TRUE; \nEND_IF\n\n", "title": "elevator-FUN\\F_RegisterCalls.st"}, {"text": "VAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u4f4e\u697c\u5c42\u7684\u8bf7\u6c42\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u79fb\u52a8\u903b\u8f91\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION F_DetectCurrentFloor : INT\nVAR_INPUT\n\tFloorSensor0\t:\tBOOL;\t\t// 0\u697c\u4f20\u611f\u5668\n\tFloorSensor1\t:\tBOOL;\t\t// 1\u697c\u4f20\u611f\u5668\n\tFloorSensor2\t:\tBOOL;\t\t// 2\u697c\u4f20\u611f\u5668\n\tFloorSensor3\t:\tBOOL;\t\t// 3\u697c\u4f20\u611f\u5668\n\tCurrentFloor\t:\tINT;\t\t// \u5f53\u524d\u697c\u5c42\uff08\u7528\u4e8e\u4fdd\u6301\u72b6\u6001\uff09\nEND_VAR\n\n// \u6839\u636e\u4f20\u611f\u5668\u8f93\u5165\u786e\u5b9a\u5f53\u524d\u697c\u5c42\nIF FloorSensor0 THEN \n\tF_DetectCurrentFloor := 0;\nELSIF FloorSensor1 THEN \n\tF_DetectCurrentFloor := 1;\nELSIF FloorSensor2 THEN \n\tF_DetectCurrentFloor := 2;\nELSIF FloorSensor3 THEN \n\tF_DetectCurrentFloor := 3;\nELSE\n\t// \u6ca1\u6709\u4f20\u611f\u5668\u4fe1\u53f7\u65f6\uff0c\u4fdd\u6301\u5f53\u524d\u697c\u5c42\n\tF_DetectCurrentFloor := CurrentFloor;\nEND_IF\n\n", "title": "elevator-FUN\\F_DetectCurrentFloor.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "PROGRAM PLC_PRG\nVAR\n\t// \u8f93\u5165\u4fe1\u53f7\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// \u8f93\u51fa\u4fe1\u53f7\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// \u5185\u90e8\u53d8\u91cf\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// \u4f7f\u7528\u91cd\u6784\u540e\u7684\u529f\u80fd\u5757\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// \u95e8\u63a7\u5236\u5668\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// \u79fb\u52a8\u63a7\u5236\u5668\n\t\n\t// \u95e8\u5f00\u5173\u52a8\u753b\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== \u7d27\u6025\u505c\u6b62\u5904\u7406 ==========\n", "title": "elevator-PRG\\PLC_PRG.st"}, {"text": "VAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // \u7b49\u5f85\u5f00\u59cb\u5173\u95e8\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // \u5f00\u59cb\u5173\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t4: // \u5173\u95e8\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n\t\tbDoorOpen := FALSE;\n\t\tfbCloseDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbCloseDoorTimer.Q AND bDoorClosed THEN\n\t\t\tfbCloseDoorTimer(IN := FALSE);\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}], "metadata": {"task_id": "elevator/3", "ground_truth": "FUNCTION F_RegisterCalls\nVAR_INPUT\n\tCallGround\t\t:\tBOOL;\t\t// 0\u697c\u547c\u53eb\n\tCallFloor1\t\t:\tBOOL;\t\t// 1\u697c\u547c\u53eb\n\tCallFloor2\t\t:\tBOOL;\t\t// 2\u697c\u547c\u53eb\n\tCallFloor3\t\t:\tBOOL;\t\t// 3\u697c\u547c\u53eb\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\n\n// \u6ce8\u518c\u5404\u697c\u5c42\u7684\u547c\u53eb\u8bf7\u6c42\nIF CallGround THEN \n\tTargetFloors[0] := TRUE; \nEND_IF\n\nIF CallFloor1 THEN \n\tTargetFloors[1] := TRUE; \nEND_IF\n\nIF CallFloor2 THEN \n\tTargetFloors[2] := TRUE; \nEND_IF\n\nIF CallFloor3 THEN \n\tTargetFloors[3] := TRUE; \nEND_IF", "fpath_tuple": ["FUN", "F_RegisterCalls.st"], "context_start_lineno": 0, "lineno": 11, "function_name": "F_RegisterCalls"}}
{"prompt": "FUNCTION F_UpdateDoorAnimation : DINT\nVAR_INPUT\n\tbOpenDoor\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbCallFloor\t\t:\tBOOL;\t\t// \u8be5\u697c\u5c42\u6709\u547c\u53eb\n\tnCurrentAni\t\t:\tDINT;\t\t// \u5f53\u524d\u52a8\u753b\u503c\n\tnMaxAni\t\t\t:\tDINT := 70;\t// \u6700\u5927\u52a8\u753b\u503c\nEND_VAR", "reference": "FUNCTION F_UpdateDoorAnimation : DINT\nVAR_INPUT\n\tbOpenDoor\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbCallFloor\t\t:\tBOOL;\t\t// \u8be5\u697c\u5c42\u6709\u547c\u53eb\n\tnCurrentAni\t\t:\tDINT;\t\t// \u5f53\u524d\u52a8\u753b\u503c\n\tnMaxAni\t\t\t:\tDINT := 70;\t// \u6700\u5927\u52a8\u753b\u503c\nEND_VAR\nVAR\n\tnNewAni\t\t\t:\tDINT;\t\t// \u65b0\u7684\u52a8\u753b\u503c\nEND_VAR\n\nnNewAni := nCurrentAni;\n\n// \u5f00\u95e8\u52a8\u753b\uff08\u589e\u52a0\u52a8\u753b\u503c\uff09\nIF bOpenDoor AND nNewAni < nMaxAni AND bCallFloor THEN\n\tnNewAni := nNewAni + 1;\nEND_IF\n\n// \u5173\u95e8\u52a8\u753b\uff08\u51cf\u5c11\u52a8\u753b\u503c\uff09\nIF bCloseDoor AND nNewAni > 0 THEN\n\tnNewAni := nNewAni - 1;\nEND_IF\n\nF_UpdateDoorAnimation := nNewAni;", "docs": [{"text": "FUNCTION F_UpdateDoorAnimation : DINT\nVAR_INPUT\n\tbOpenDoor\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbCallFloor\t\t:\tBOOL;\t\t// \u8be5\u697c\u5c42\u6709\u547c\u53eb\n\tnCurrentAni\t\t:\tDINT;\t\t// \u5f53\u524d\u52a8\u753b\u503c\n\tnMaxAni\t\t\t:\tDINT := 70;\t// \u6700\u5927\u52a8\u753b\u503c\nEND_VAR\nVAR\n\tnNewAni\t\t\t:\tDINT;\t\t// \u65b0\u7684\u52a8\u753b\u503c\nEND_VAR\n\nnNewAni := nCurrentAni;\n\n// \u5f00\u95e8\u52a8\u753b\uff08\u589e\u52a0\u52a8\u753b\u503c\uff09\nIF bOpenDoor AND nNewAni < nMaxAni AND bCallFloor THEN\n\tnNewAni := nNewAni + 1;\nEND_IF\n\n// \u5173\u95e8\u52a8\u753b\uff08\u51cf\u5c11\u52a8\u753b\u503c\uff09\nIF bCloseDoor AND nNewAni > 0 THEN\n\tnNewAni := nNewAni - 1;\nEND_IF\n\nF_UpdateDoorAnimation := nNewAni;\n\n", "title": "elevator-FUN\\F_UpdateDoorAnimation.st"}, {"text": "FUNCTION F_UpdateDoorAnimation : DINT\nVAR_INPUT\n\tbOpenDoor\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbCallFloor\t\t:\tBOOL;\t\t// \u8be5\u697c\u5c42\u6709\u547c\u53eb\n\tnCurrentAni\t\t:\tDINT;\t\t// \u5f53\u524d\u52a8\u753b\u503c\n\tnMaxAni\t\t\t:\tDINT := 70;\t// \u6700\u5927\u52a8\u753b\u503c\nEND_VAR\nVAR\n\tnNewAni\t\t\t:\tDINT;\t\t// \u65b0\u7684\u52a8\u753b\u503c\nEND_VAR\n\nnNewAni := nCurrentAni;\n\n// \u5f00\u95e8\u52a8\u753b\uff08\u589e\u52a0\u52a8\u753b\u503c\uff09\nIF bOpenDoor AND nNewAni < nMaxAni AND bCallFloor THEN\n\tnNewAni := nNewAni + 1;\nEND_IF\n\n// \u5173\u95e8\u52a8\u753b\uff08\u51cf\u5c11\u52a8\u753b\u503c\uff09\nIF bCloseDoor AND nNewAni > 0 THEN\n\tnNewAni := nNewAni - 1;\nEND_IF\n\nF_UpdateDoorAnimation := nNewAni;\n", "title": "elevator-FUN\\F_UpdateDoorAnimation.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "VAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// \u95e8\u6253\u5f00\u72b6\u6001\n\tbDoorReady\t\t\t:\tBOOL;\t\t// \u95e8\u51c6\u5907\u597d\uff08\u53ef\u4ee5\u79fb\u52a8\uff09\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // \u5f00\u95e8\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // \u7b49\u5f85\u5f00\u59cb\u5173\u95e8\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // \u5f00\u59cb\u5173\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\t\t\n\t4: // \u5173\u95e8\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n\t\tbDoorOpen := FALSE;\n\t\tfbCloseDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbCloseDoorTimer.Q AND bDoorClosed THEN\n\t\t\tfbCloseDoorTimer(IN := FALSE);\n", "title": "elevator-FUN\\FB_ElevatorDoorController.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// \u5f53\u524d\u697c\u5c42\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// \u95e8\u51c6\u5907\u597d\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// \u76ee\u6807\u697c\u5c42\u6570\u7ec4\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0a\u79fb\u52a8\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// \u5411\u4e0b\u79fb\u52a8\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// \u5230\u8fbe\u76ee\u6807\u697c\u5c42\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// \u79fb\u52a8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// \u53ea\u6709\u95e8\u51c6\u5907\u597d\u624d\u80fd\u79fb\u52a8\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u9ad8\u697c\u5c42\u7684\u8bf7\u6c42\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// \u68c0\u67e5\u662f\u5426\u6709\u66f4\u4f4e\u697c\u5c42\u7684\u8bf7\u6c42\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n", "title": "elevator-FUN\\FB_ElevatorMovement.st"}, {"text": "FUNCTION F_DetectCurrentFloor : INT\nVAR_INPUT\n\tFloorSensor0\t:\tBOOL;\t\t// 0\u697c\u4f20\u611f\u5668\n\tFloorSensor1\t:\tBOOL;\t\t// 1\u697c\u4f20\u611f\u5668\n\tFloorSensor2\t:\tBOOL;\t\t// 2\u697c\u4f20\u611f\u5668\n\tFloorSensor3\t:\tBOOL;\t\t// 3\u697c\u4f20\u611f\u5668\n\tCurrentFloor\t:\tINT;\t\t// \u5f53\u524d\u697c\u5c42\uff08\u7528\u4e8e\u4fdd\u6301\u72b6\u6001\uff09\nEND_VAR\n\n// \u6839\u636e\u4f20\u611f\u5668\u8f93\u5165\u786e\u5b9a\u5f53\u524d\u697c\u5c42\nIF FloorSensor0 THEN \n\tF_DetectCurrentFloor := 0;\nELSIF FloorSensor1 THEN \n\tF_DetectCurrentFloor := 1;\nELSIF FloorSensor2 THEN \n\tF_DetectCurrentFloor := 2;\nELSIF FloorSensor3 THEN \n\tF_DetectCurrentFloor := 3;\nELSE\n\t// \u6ca1\u6709\u4f20\u611f\u5668\u4fe1\u53f7\u65f6\uff0c\u4fdd\u6301\u5f53\u524d\u697c\u5c42\n\tF_DetectCurrentFloor := CurrentFloor;\nEND_IF\n\n", "title": "elevator-FUN\\F_DetectCurrentFloor.st"}], "metadata": {"task_id": "elevator/4", "ground_truth": "FUNCTION F_UpdateDoorAnimation : DINT\nVAR_INPUT\n\tbOpenDoor\t\t:\tBOOL;\t\t// \u5f00\u95e8\u547d\u4ee4\n\tbCloseDoor\t\t:\tBOOL;\t\t// \u5173\u95e8\u547d\u4ee4\n\tbCallFloor\t\t:\tBOOL;\t\t// \u8be5\u697c\u5c42\u6709\u547c\u53eb\n\tnCurrentAni\t\t:\tDINT;\t\t// \u5f53\u524d\u52a8\u753b\u503c\n\tnMaxAni\t\t\t:\tDINT := 70;\t// \u6700\u5927\u52a8\u753b\u503c\nEND_VAR\nVAR\n\tnNewAni\t\t\t:\tDINT;\t\t// \u65b0\u7684\u52a8\u753b\u503c\nEND_VAR\n\nnNewAni := nCurrentAni;\n\n// \u5f00\u95e8\u52a8\u753b\uff08\u589e\u52a0\u52a8\u753b\u503c\uff09\nIF bOpenDoor AND nNewAni < nMaxAni AND bCallFloor THEN\n\tnNewAni := nNewAni + 1;\nEND_IF\n\n// \u5173\u95e8\u52a8\u753b\uff08\u51cf\u5c11\u52a8\u753b\u503c\uff09\nIF bCloseDoor AND nNewAni > 0 THEN\n\tnNewAni := nNewAni - 1;\nEND_IF\n\nF_UpdateDoorAnimation := nNewAni;", "fpath_tuple": ["FUN", "F_UpdateDoorAnimation.st"], "context_start_lineno": 0, "lineno": 9, "function_name": "F_UpdateDoorAnimation"}}
