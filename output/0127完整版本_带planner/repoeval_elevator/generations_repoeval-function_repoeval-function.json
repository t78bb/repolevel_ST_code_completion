[["```\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// \u5f00\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tfbCloseDoorTimer\t:\tTON;\t\t// \u5173\u95e8\u5ef6\u65f6\u5b9a\u65f6\u5668\n\tnState\t\t\t\t:\tINT;\t\t// \u72b6\u6001\u673a\n\tbEmergencyStop\t\t:\tBOOL;\t\t// \u7d27\u6025\u505c\u6b62\u4fe1\u53f7\nEND_VAR\n\nCASE nState OF\n\t0: // \u7a7a\u95f2\u72b6\u6001\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorOpen := FALSE;\n\t\tbDoorReady := TRUE;\n\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // \u5f00\u59cb\u5f00\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\n\t1: // \u5f00\u95e8\u5ef6\u65f6\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tbOpenDoor := TRUE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2; // \u95e8\u6253\u5f00\u72b6\u6001\n\t\tEND_IF\n\n\t2: // \u95e8\u6253\u5f00\u72b6\u6001\n\t\tbDoorOpen := TRUE;\n\t\tbOpenDoor := FALSE;\n\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 3; // \u5f00\u59cb\u5173\u95e8\u6d41\u7a0b\n\t\tEND_IF\n\n\t3: // \u5173\u95e8\u5ef6\u65f6\n\t\tbOpenDoor := FALSE;\n\t\tbDoorOpen := FALSE;\n\t\tbCloseDoor := TRUE;\n\t\tfbCloseDoorTimer(IN := TRUE, PT := T#2S);\n\n\t\tIF fbCloseDoorTimer.Q THEN\n\t\t\tfbCloseDoorTimer(IN := FALSE);\n\t\t\tnState := 4; // \u68c0\u67e5\u95e8\u5173\u95ed\u72b6\u6001\n\t\tEND_IF\n\n\t4: // \u68c0\u67e5\u95e8\u5173\u95ed\u72b6\u6001\n\t\tbCloseDoor := FALSE;\n\n\t\tIF bDoorClosed THEN\n\t\t\tbDoorReady := TRUE;\n\t\t\tnState := 0; // \u8fd4\u56de\u7a7a\u95f2\u72b6\u6001\n\t\tEND_IF\n\nELSE\n\t// \u5f02\u5e38\u5904\u7406\n\tbOpenDoor := FALSE;\n\tbCloseDoor := FALSE;\n\tbDoorOpen := FALSE;\n\tbDoorReady := FALSE;\n\tnState := 0; // \u8fd4\u56de\u7a7a\u95f2\u72b6\u6001\nEND_CASE\n```"], ["```\nVAR\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// \u5faa\u73af\u53d8\u91cf\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u9ad8\u697c\u5c42\u8bf7\u6c42\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// \u6709\u66f4\u4f4e\u697c\u5c42\u8bf7\u6c42\nEND_VAR\n\n// \u521d\u59cb\u5316\u72b6\u6001\u53d8\u91cf\nbHasUpperRequest := FALSE;\nbHasLowerRequest := FALSE;\n\n// \u904d\u5386\u76ee\u6807\u697c\u5c42\u6570\u7ec4\nFOR i := 0 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tIF (i > CurrentFloor) AND bDoorReady THEN\n\t\t\tbHasUpperRequest := TRUE;\n\t\tELSIF (i < CurrentFloor) AND bDoorReady THEN\n\t\t\tbHasLowerRequest := TRUE;\n\t\tEND_IF;\n\tEND_IF;\nEND_FOR\n\n// \u6839\u636e\u8bf7\u6c42\u72b6\u6001\u8bbe\u7f6e\u79fb\u52a8\u65b9\u5411\nIF bHasUpperRequest THEN\n\tbMovingUp := TRUE;\n\tbMovingDown := FALSE;\nELSIF bHasLowerRequest THEN\n\tbMovingDown := TRUE;\n\tbMovingUp := FALSE;\nELSE\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\nEND_IF\n\n// \u68c0\u67e5\u662f\u5426\u5230\u8fbe\u76ee\u6807\u697c\u5c42\nIF TargetFloors[CurrentFloor] THEN\n\tIF bDoorReady THEN\n\t\tbArrivedAtTarget := TRUE;\n\t\tTargetFloors[CurrentFloor] := FALSE; // \u6e05\u9664\u8bf7\u6c42\n\t\tbMovingUp := FALSE;\n\t\tbMovingDown := FALSE;\n\tELSE\n\t\tbArrivedAtTarget := FALSE;\n\tEND_IF;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n```"], ["```\nIF FloorSensor0 THEN \n\tF_DetectCurrentFloor := 0;\nELSIF FloorSensor1 THEN \n\tF_DetectCurrentFloor := 1;\nELSIF FloorSensor2 THEN \n\tF_DetectCurrentFloor := 2;\nELSIF FloorSensor3 THEN \n\tF_DetectCurrentFloor := 3;\nELSE\n\tF_DetectCurrentFloor := CurrentFloor;\nEND_IF;\nRETURN;\n```"], ["```\nIF CallGround THEN \n\tTargetFloors[0] := TRUE; \nEND_IF\n\nIF CallFloor1 THEN \n\tTargetFloors[1] := TRUE; \nEND_IF\n\nIF CallFloor2 THEN \n\tTargetFloors[2] := TRUE; \nEND_IF\n\nIF CallFloor3 THEN \n\tTargetFloors[3] := TRUE; \nEND_IF\n\nRETURN;\n```"], ["```\nVAR\n\tnNewAni\t\t\t:\tDINT;\t\t// \u65b0\u7684\u52a8\u753b\u503c\nEND_VAR\n\nnNewAni := nCurrentAni;\n\n// \u5f00\u95e8\u52a8\u753b\uff08\u589e\u52a0\u52a8\u753b\u503c\uff09\nIF bOpenDoor AND nNewAni < nMaxAni THEN\n\tnNewAni := nNewAni + 1;\nEND_IF\n\n// \u5173\u95e8\u52a8\u753b\uff08\u51cf\u5c11\u52a8\u753b\u503c\uff09\nIF bCloseDoor AND nNewAni > 0 THEN\n\tnNewAni := nNewAni - 1;\nEND_IF\n\n// \u697c\u5c42\u547c\u53eb\u52a8\u753b\uff08\u589e\u52a0\u52a8\u753b\u503c\uff09\nIF bCallFloor AND nNewAni < nMaxAni THEN\n\tnNewAni := nNewAni + 1;\nEND_IF\n\n// \u4fdd\u6301\u52a8\u753b\u503c\u4e0d\u53d8\nIF NOT bCallFloor AND NOT bOpenDoor AND NOT bCloseDoor THEN\n\tnNewAni := nCurrentAni;\nEND_IF\n\nF_UpdateDoorAnimation := nNewAni;\n```"]]