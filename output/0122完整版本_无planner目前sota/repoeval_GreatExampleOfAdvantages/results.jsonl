{"requirement": "This code is intended to implement a functional block for managing operations related to a ground floor and a top floor.", "provide_code": "FUNCTION_BLOCK Home\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR", "docs": [{"text": "FUNCTION_BLOCK Home\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tGroundFloor:GroundFloor;\n\tTopFloor:TopFloor;\nEND_VAR\n\nGroundFloor();\nTopFloor();", "title": "GreatExampleOfAdvantages-FUN\\Home.st"}, {"text": "FUNCTION_BLOCK TopFloor\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tMainBath:MainBath;\n\tSleepingRoom:SleepingRoom;\nEND_VAR\n\nMainBath();\nSleepingRoom();", "title": "GreatExampleOfAdvantages-FUN\\TopFloor.st"}, {"text": "FUNCTION_BLOCK GroundFloor\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLivingRoom:LivingRoom;\n\tGuestBath:GuestBathGroundFloor;\nEND_VAR\n\nLivingRoom();\nGuestBath();", "title": "GreatExampleOfAdvantages-FUN\\GroundFloor.st"}, {"text": "FUNCTION_BLOCK LivingRoom\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\n\tLamp2:LampBase;\n\tLamp3:LampBase;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t\n\tligthButton1: BOOL;\n\tligthButton2: BOOL;\n\tligthButton3: BOOL;\n\t\n\tLamp1Out: BOOL;\n\tLamp2Out: BOOL;\n\tLamp3Out: BOOL;\n\t//some changing temp...\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\t\nEND_VAR\n\n", "title": "GreatExampleOfAdvantages-FUN\\LivingRoom.st"}, {"text": "FUNCTION_BLOCK LivingRoom\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\n\tLamp2:LampBase;\n\tLamp3:LampBase;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t\n\tligthButton1: BOOL;\n\tligthButton2: BOOL;\n\tligthButton3: BOOL;\n\t\n\tLamp1Out: BOOL;\n\tLamp2Out: BOOL;\n\tLamp3Out: BOOL;\n\t//some changing temp...\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\t\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\nLamp2(SwitchIn:= ligthButton2, LampOut=> Lamp2Out);\nLamp3(SwitchIn:= ligthButton3, LampOut=> Lamp3Out);\n\nTemp(\n", "title": "GreatExampleOfAdvantages-FUN\\LivingRoom.st"}, {"text": "FUNCTION_BLOCK LivingRoom\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\n\tLamp2:LampBase;\n\tLamp3:LampBase;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t\n\tligthButton1: BOOL;\n\tligthButton2: BOOL;\n\tligthButton3: BOOL;\n\t\n\tLamp1Out: BOOL;\n\tLamp2Out: BOOL;\n\tLamp3Out: BOOL;\n\t//some changing temp...\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\t\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\nLamp2(SwitchIn:= ligthButton2, LampOut=> Lamp2Out);\nLamp3(SwitchIn:= ligthButton3, LampOut=> Lamp3Out);\n\nTemp(\n\tPT:= T#30S, \n\tAM:= 2.0, \n\tOS:= 20.0, \n\tDL:= 0.0);\n\n", "title": "GreatExampleOfAdvantages-FUN\\LivingRoom.st"}, {"text": "FUNCTION_BLOCK LivingRoom\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\n\tLamp2:LampBase;\n\tLamp3:LampBase;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t\n\tligthButton1: BOOL;\n\tligthButton2: BOOL;\n\tligthButton3: BOOL;\n\t\n\tLamp1Out: BOOL;\n\tLamp2Out: BOOL;\n\tLamp3Out: BOOL;\n\t//some changing temp...\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\t\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\nLamp2(SwitchIn:= ligthButton2, LampOut=> Lamp2Out);\nLamp3(SwitchIn:= ligthButton3, LampOut=> Lamp3Out);\n\nTemp(\n\tPT:= T#30S, \n\tAM:= 2.0, \n\tOS:= 20.0, \n\tDL:= 0.0);\n\nTemperature(tempIn:= Temp.Out);", "title": "GreatExampleOfAdvantages-FUN\\LivingRoom.st"}, {"text": "FUNCTION_BLOCK MainBath\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\n\tLamp2:LampBase;\n\tLamp3:LampBase;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t\n\tligthButton1: BOOL;\n\tligthButton2: BOOL;\n\tligthButton3: BOOL;\n\t\n\tLamp1Out: BOOL;\n\tLamp2Out: BOOL;\n\tLamp3Out: BOOL;\n\t//some changing temp...\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\nEND_VAR\n\n", "title": "GreatExampleOfAdvantages-FUN\\MainBath.st"}, {"text": "FUNCTION_BLOCK MainBath\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\n\tLamp2:LampBase;\n\tLamp3:LampBase;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t\n\tligthButton1: BOOL;\n\tligthButton2: BOOL;\n\tligthButton3: BOOL;\n\t\n\tLamp1Out: BOOL;\n\tLamp2Out: BOOL;\n\tLamp3Out: BOOL;\n\t//some changing temp...\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\nLamp2(SwitchIn:= ligthButton2, LampOut=> Lamp2Out);\nLamp3(SwitchIn:= ligthButton3, LampOut=> Lamp3Out);\n\nTemp(\n", "title": "GreatExampleOfAdvantages-FUN\\MainBath.st"}, {"text": "FUNCTION_BLOCK MainBath\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\n\tLamp2:LampBase;\n\tLamp3:LampBase;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t\n\tligthButton1: BOOL;\n\tligthButton2: BOOL;\n\tligthButton3: BOOL;\n\t\n\tLamp1Out: BOOL;\n\tLamp2Out: BOOL;\n\tLamp3Out: BOOL;\n\t//some changing temp...\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\nLamp2(SwitchIn:= ligthButton2, LampOut=> Lamp2Out);\nLamp3(SwitchIn:= ligthButton3, LampOut=> Lamp3Out);\n\nTemp(\n\tPT:= T#40S, \n\tAM:= 1.0, \n\tOS:= 20.0, \n\tDL:= 0.0);\n\n", "title": "GreatExampleOfAdvantages-FUN\\MainBath.st"}, {"text": "FUNCTION_BLOCK MainBath\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\n\tLamp2:LampBase;\n\tLamp3:LampBase;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t\n\tligthButton1: BOOL;\n\tligthButton2: BOOL;\n\tligthButton3: BOOL;\n\t\n\tLamp1Out: BOOL;\n\tLamp2Out: BOOL;\n\tLamp3Out: BOOL;\n\t//some changing temp...\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\nLamp2(SwitchIn:= ligthButton2, LampOut=> Lamp2Out);\nLamp3(SwitchIn:= ligthButton3, LampOut=> Lamp3Out);\n\nTemp(\n\tPT:= T#40S, \n\tAM:= 1.0, \n\tOS:= 20.0, \n\tDL:= 0.0);\n\nTemperature(tempIn:= Temp.Out);", "title": "GreatExampleOfAdvantages-FUN\\MainBath.st"}, {"text": "FUNCTION_BLOCK GuestBathGroundFloor\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\n\nVAR\n\tLamp1:LampBase;\t\t\n\t\n\tligthButton1: BOOL;\n\t\n\tLamp1Out: BOOL;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t//gernerates a sin as temperature\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\t//MQTT\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\n\nTemp(\n\tPT:= T#20S, \n\tAM:= 1.5, \n", "title": "GreatExampleOfAdvantages-FUN\\GuestBathGroundFloor.st"}, {"text": "FUNCTION_BLOCK SleepingRoom\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\t\t\n\t\n\tligthButton1: BOOL;\n\t\n\tLamp1Out: BOOL;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t//gernerates a sin as temperature\n\tTemp:OSCAT_BASIC.GEN_SIN;\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\n\nTemp(\n\tPT:= T#60S, \n\tAM:= 1.5, \n\tOS:= 15.0, \n\tDL:= 0.0);\n", "title": "GreatExampleOfAdvantages-FUN\\SleepingRoom.st"}, {"text": "FUNCTION_BLOCK SleepingRoom\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLamp1:LampBase;\t\t\n\t\n\tligthButton1: BOOL;\n\t\n\tLamp1Out: BOOL;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t//gernerates a sin as temperature\n\tTemp:OSCAT_BASIC.GEN_SIN;\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\n\nTemp(\n\tPT:= T#60S, \n\tAM:= 1.5, \n\tOS:= 15.0, \n\tDL:= 0.0);\n\t\n\t\nTemperature(tempIn:= Temp.Out);", "title": "GreatExampleOfAdvantages-FUN\\SleepingRoom.st"}, {"text": "FUNCTION_BLOCK GuestBathGroundFloor\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\n\nVAR\n\tLamp1:LampBase;\t\t\n\t\n\tligthButton1: BOOL;\n\t\n\tLamp1Out: BOOL;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t//gernerates a sin as temperature\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\t//MQTT\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\n\nTemp(\n\tPT:= T#20S, \n\tAM:= 1.5, \n\tOS:= 20.0, \n\tDL:= 0.0);\n\t\n\t\nTemperature(tempIn:= Temp.Out);", "title": "GreatExampleOfAdvantages-FUN\\GuestBathGroundFloor.st"}, {"text": "FUNCTION_BLOCK TopicsBase\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tMyTopicSend:STRING(255);\n\tMyTopicReceive:STRING(255);\n\tinit: BOOL;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\t//MyTopic := InstanceName.GetInstanceTopic();\n\tMyTopicSend := InsertSendToStringTopic(in:= InstanceName.GetInstanceTopic(), TopicLevel:= 1);\n\tMyTopicReceive := InsertReceiveToStringTopic(in:= InstanceName.GetInstanceTopic(), TopicLevel:= 1);\nEND_IF", "title": "GreatExampleOfAdvantages-FUN\\TopicsBase.st"}, {"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n\tfound := CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic), str2:= ADR('/'));\n\tfound := found + 1 + CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic[found + 1]), str2:= ADR('/'));\n\tpt := ADR(SubscribeTopic[found  + 1]);\n\tpt^ := 'Receive/#'; \n\tGVL_MQTT.MQTT_IN_OUT.ClientID := CONCAT('CodesysMqtt',TO_STRING(TICKS.GetTick(xDummy:= TRUE)));\nEND_IF\n\n\nGVL_MQTT.MQTT_IN_OUT.clientFB( \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n\tfound := CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic), str2:= ADR('/'));\n\tfound := found + 1 + CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic[found + 1]), str2:= ADR('/'));\n\tpt := ADR(SubscribeTopic[found  + 1]);\n\tpt^ := 'Receive/#'; \n\tGVL_MQTT.MQTT_IN_OUT.ClientID := CONCAT('CodesysMqtt',TO_STRING(TICKS.GetTick(xDummy:= TRUE)));\n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n\tfound := CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic), str2:= ADR('/'));\n\tfound := found + 1 + CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic[found + 1]), str2:= ADR('/'));\n\tpt := ADR(SubscribeTopic[found  + 1]);\n\tpt^ := 'Receive/#'; \n\tGVL_MQTT.MQTT_IN_OUT.ClientID := CONCAT('CodesysMqtt',TO_STRING(TICKS.GetTick(xDummy:= TRUE)));\nEND_IF\n\n\nGVL_MQTT.MQTT_IN_OUT.clientFB( \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n\tENABLE:= TRUE, \n\tURL:= 'broker.hivemq.com:1883', \n\tTIMEOUT:= T#8S);\n\t\nSubscriber(\n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}], "task_id": "Home"}
{"requirement": "This code is intended to implement an MQTT client functionality that connects to a broker, subscribes to a topic, and publishes a birth message upon successful connection.", "provide_code": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR", "docs": [{"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n\tfound := CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic), str2:= ADR('/'));\n\tfound := found + 1 + CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic[found + 1]), str2:= ADR('/'));\n\tpt := ADR(SubscribeTopic[found  + 1]);\n\tpt^ := 'Receive/#'; \n\tGVL_MQTT.MQTT_IN_OUT.ClientID := CONCAT('CodesysMqtt',TO_STRING(TICKS.GetTick(xDummy:= TRUE)));\nEND_IF\n\n\nGVL_MQTT.MQTT_IN_OUT.clientFB( \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n\tfound := CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic), str2:= ADR('/'));\n\tfound := found + 1 + CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic[found + 1]), str2:= ADR('/'));\n\tpt := ADR(SubscribeTopic[found  + 1]);\n\tpt^ := 'Receive/#'; \n\tGVL_MQTT.MQTT_IN_OUT.ClientID := CONCAT('CodesysMqtt',TO_STRING(TICKS.GetTick(xDummy:= TRUE)));\nEND_IF\n\n\nGVL_MQTT.MQTT_IN_OUT.clientFB( \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n\tENABLE:= TRUE, \n\tURL:= 'broker.hivemq.com:1883', \n\tTIMEOUT:= T#8S);\n\t\nSubscriber(\n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n\tfound := CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic), str2:= ADR('/'));\n\tfound := found + 1 + CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic[found + 1]), str2:= ADR('/'));\n\tpt := ADR(SubscribeTopic[found  + 1]);\n\tpt^ := 'Receive/#'; \n\tGVL_MQTT.MQTT_IN_OUT.ClientID := CONCAT('CodesysMqtt',TO_STRING(TICKS.GetTick(xDummy:= TRUE)));\nEND_IF\n\n\nGVL_MQTT.MQTT_IN_OUT.clientFB( \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n\tENABLE:= TRUE, \n\tURL:= 'broker.hivemq.com:1883', \n\tTIMEOUT:= T#8S);\n\t\nSubscriber(\n\tSubscribe:= TRUE, \n\tTopic:= ADR(SubscribeTopic), \n\tQoSSubscribe:= MQTT.QoS.ExactlyOnce, \n\tExpectingString:= TRUE, \n\tCallback:= MyProperty.Collector);\n\t\nconnectRising(CLK:= GVL_MQTT.MQTT_IN_OUT.BROKER_CONNECTED);\n\n\tbirthMessage(\n\tTopic:= ADR(birthTopic), \n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n\tfound := CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic), str2:= ADR('/'));\n\tfound := found + 1 + CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic[found + 1]), str2:= ADR('/'));\n\tpt := ADR(SubscribeTopic[found  + 1]);\n\tpt^ := 'Receive/#'; \n\tGVL_MQTT.MQTT_IN_OUT.ClientID := CONCAT('CodesysMqtt',TO_STRING(TICKS.GetTick(xDummy:= TRUE)));\nEND_IF\n\n\nGVL_MQTT.MQTT_IN_OUT.clientFB( \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n\tENABLE:= TRUE, \n\tURL:= 'broker.hivemq.com:1883', \n\tTIMEOUT:= T#8S);\n\t\nSubscriber(\n\tSubscribe:= TRUE, \n\tTopic:= ADR(SubscribeTopic), \n\tQoSSubscribe:= MQTT.QoS.ExactlyOnce, \n\tExpectingString:= TRUE, \n\tCallback:= MyProperty.Collector);\n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "FUNCTION_BLOCK MQTT_STUFF\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n\tfound := CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic), str2:= ADR('/'));\n\tfound := found + 1 + CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic[found + 1]), str2:= ADR('/'));\n\tpt := ADR(SubscribeTopic[found  + 1]);\n\tpt^ := 'Receive/#'; \n\tGVL_MQTT.MQTT_IN_OUT.ClientID := CONCAT('CodesysMqtt',TO_STRING(TICKS.GetTick(xDummy:= TRUE)));\n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "FUNCTION_BLOCK TopFloor\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tMainBath:MainBath;\n\tSleepingRoom:SleepingRoom;\nEND_VAR\n\nMainBath();\nSleepingRoom();", "title": "GreatExampleOfAdvantages-FUN\\TopFloor.st"}, {"text": "FUNCTION_BLOCK GuestBathGroundFloor\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\n\nVAR\n\tLamp1:LampBase;\t\t\n\t\n\tligthButton1: BOOL;\n\t\n\tLamp1Out: BOOL;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t//gernerates a sin as temperature\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\t//MQTT\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\n\nTemp(\n\tPT:= T#20S, \n\tAM:= 1.5, \n", "title": "GreatExampleOfAdvantages-FUN\\GuestBathGroundFloor.st"}, {"text": "FUNCTION_BLOCK GroundFloor\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tLivingRoom:LivingRoom;\n\tGuestBath:GuestBathGroundFloor;\nEND_VAR\n\nLivingRoom();\nGuestBath();", "title": "GreatExampleOfAdvantages-FUN\\GroundFloor.st"}, {"text": "FUNCTION_BLOCK Home\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tGroundFloor:GroundFloor;\n\tTopFloor:TopFloor;\nEND_VAR\n\nGroundFloor();\nTopFloor();", "title": "GreatExampleOfAdvantages-FUN\\Home.st"}, {"text": "FUNCTION_BLOCK LampBase EXTENDS TopicsBase IMPLEMENTS MQTT.MQTT_SUBSCRIBE_CALLBACK\nVAR_INPUT\n\t(*toggels lamp, sends publish*)\t\n\tSwitchIn: BOOL;\n\nEND_VAR\nVAR_OUTPUT\n\tLampOut: BOOL;\n\nEND_VAR\nVAR\n\tMyInit: BOOL;\n\tSendState:MQTT.MQTTState;\n\tSwitchTrigger:R_TRIG;\nEND_VAR\n\nIF NOT MyInit THEN\n\tMyInit := TRUE;\n\tSUPER^();\n\t//this is for transmitting the lamp state\n\t(*SendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tStateValueOn:= ADR('Lamp switched On'), \n\tStateValueOff:= ADR('Lamp switched Off'), \n\tMQTT_IN_OUT REF= GVL_MQTT.MQTT_IN_OUT, \n\tQoS:= SD_MQTT.QoS.ExactlyOnce,\n\tRetainMqtt:= TRUE);*)\n\tMyProperty.Collector.put(instance:= THIS^);\n\tSendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n", "title": "GreatExampleOfAdvantages-FUN\\LampBase.st"}, {"text": "FUNCTION_BLOCK LampBase EXTENDS TopicsBase IMPLEMENTS MQTT.MQTT_SUBSCRIBE_CALLBACK\nVAR_INPUT\n\t(*toggels lamp, sends publish*)\t\n\tSwitchIn: BOOL;\n\nEND_VAR\nVAR_OUTPUT\n\tLampOut: BOOL;\n\nEND_VAR\nVAR\n\tMyInit: BOOL;\n\tSendState:MQTT.MQTTState;\n\tSwitchTrigger:R_TRIG;\nEND_VAR\n\nIF NOT MyInit THEN\n\tMyInit := TRUE;\n\tSUPER^();\n\t//this is for transmitting the lamp state\n\t(*SendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tStateValueOn:= ADR('Lamp switched On'), \n\tStateValueOff:= ADR('Lamp switched Off'), \n\tMQTT_IN_OUT REF= GVL_MQTT.MQTT_IN_OUT, \n\tQoS:= SD_MQTT.QoS.ExactlyOnce,\n\tRetainMqtt:= TRUE);*)\n\tMyProperty.Collector.put(instance:= THIS^);\n\tSendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n\tStateValueOn:= ADR('Lamp switched On'), \n\tStateValueOff:= ADR('Lamp switched Off'), \n\tQoS:= MQTT.QoS.ExactlyOnce, \n\tRetainMqtt:= TRUE);\nEND_IF\n\nSwitchTrigger(CLK:= SwitchIn);\nIF SwitchTrigger.Q THEN\n\tLampOut := LampOut XOR 1;\nEND_IF\n", "title": "GreatExampleOfAdvantages-FUN\\LampBase.st"}, {"text": "FUNCTION_BLOCK LampBase EXTENDS TopicsBase IMPLEMENTS MQTT.MQTT_SUBSCRIBE_CALLBACK\nVAR_INPUT\n\t(*toggels lamp, sends publish*)\t\n\tSwitchIn: BOOL;\n\nEND_VAR\nVAR_OUTPUT\n\tLampOut: BOOL;\n\nEND_VAR\nVAR\n\tMyInit: BOOL;\n\tSendState:MQTT.MQTTState;\n\tSwitchTrigger:R_TRIG;\nEND_VAR\n\nIF NOT MyInit THEN\n\tMyInit := TRUE;\n\tSUPER^();\n\t//this is for transmitting the lamp state\n\t(*SendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tStateValueOn:= ADR('Lamp switched On'), \n\tStateValueOff:= ADR('Lamp switched Off'), \n\tMQTT_IN_OUT REF= GVL_MQTT.MQTT_IN_OUT, \n\tQoS:= SD_MQTT.QoS.ExactlyOnce,\n\tRetainMqtt:= TRUE);*)\n\tMyProperty.Collector.put(instance:= THIS^);\n\tSendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n\tStateValueOn:= ADR('Lamp switched On'), \n\tStateValueOff:= ADR('Lamp switched Off'), \n\tQoS:= MQTT.QoS.ExactlyOnce, \n\tRetainMqtt:= TRUE);\nEND_IF\n\nSwitchTrigger(CLK:= SwitchIn);\nIF SwitchTrigger.Q THEN\n\tLampOut := LampOut XOR 1;\nEND_IF\nSendState();", "title": "GreatExampleOfAdvantages-FUN\\LampBase.st"}, {"text": "FUNCTION_BLOCK LampBase EXTENDS TopicsBase IMPLEMENTS MQTT.MQTT_SUBSCRIBE_CALLBACK\nVAR_INPUT\n\t(*toggels lamp, sends publish*)\t\n\tSwitchIn: BOOL;\n\nEND_VAR\nVAR_OUTPUT\n\tLampOut: BOOL;\n\nEND_VAR\nVAR\n\tMyInit: BOOL;\n\tSendState:MQTT.MQTTState;\n\tSwitchTrigger:R_TRIG;\nEND_VAR\n\nIF NOT MyInit THEN\n\tMyInit := TRUE;\n\tSUPER^();\n\t//this is for transmitting the lamp state\n\t(*SendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tStateValueOn:= ADR('Lamp switched On'), \n\tStateValueOff:= ADR('Lamp switched Off'), \n\tMQTT_IN_OUT REF= GVL_MQTT.MQTT_IN_OUT, \n\tQoS:= SD_MQTT.QoS.ExactlyOnce,\n\tRetainMqtt:= TRUE);*)\n\tMyProperty.Collector.put(instance:= THIS^);\n\tSendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n\tStateValueOn:= ADR('Lamp switched On'), \n\tStateValueOff:= ADR('Lamp switched Off'), \n\tQoS:= MQTT.QoS.ExactlyOnce, \n\tRetainMqtt:= TRUE);\nEND_IF\n", "title": "GreatExampleOfAdvantages-FUN\\LampBase.st"}, {"text": "FUNCTION_BLOCK GuestBathGroundFloor\nVAR_INPUT\nEND_VAR\nVAR_OUTPUT\nEND_VAR\n\nVAR\n\tLamp1:LampBase;\t\t\n\t\n\tligthButton1: BOOL;\n\t\n\tLamp1Out: BOOL;\n\t\n\tTemperature:TemperatureBase;\n\t\n\t//gernerates a sin as temperature\n\tTemp:OSCAT_BASIC.GEN_SIN;\n\t//MQTT\nEND_VAR\n\nLamp1(SwitchIn:= ligthButton1, LampOut=> Lamp1Out);\n\nTemp(\n\tPT:= T#20S, \n\tAM:= 1.5, \n\tOS:= 20.0, \n\tDL:= 0.0);\n\t\n\t\nTemperature(tempIn:= Temp.Out);", "title": "GreatExampleOfAdvantages-FUN\\GuestBathGroundFloor.st"}, {"text": "FUNCTION_BLOCK LampBase EXTENDS TopicsBase IMPLEMENTS MQTT.MQTT_SUBSCRIBE_CALLBACK\nVAR_INPUT\n\t(*toggels lamp, sends publish*)\t\n\tSwitchIn: BOOL;\n\nEND_VAR\nVAR_OUTPUT\n\tLampOut: BOOL;\n\nEND_VAR\nVAR\n\tMyInit: BOOL;\n\tSendState:MQTT.MQTTState;\n\tSwitchTrigger:R_TRIG;\nEND_VAR\n\nIF NOT MyInit THEN\n\tMyInit := TRUE;\n\tSUPER^();\n\t//this is for transmitting the lamp state\n\t(*SendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tStateValueOn:= ADR('Lamp switched On'), \n", "title": "GreatExampleOfAdvantages-FUN\\LampBase.st"}, {"text": "FUNCTION_BLOCK LampBase EXTENDS TopicsBase IMPLEMENTS MQTT.MQTT_SUBSCRIBE_CALLBACK\nVAR_INPUT\n\t(*toggels lamp, sends publish*)\t\n\tSwitchIn: BOOL;\n\nEND_VAR\nVAR_OUTPUT\n\tLampOut: BOOL;\n\nEND_VAR\nVAR\n\tMyInit: BOOL;\n\tSendState:MQTT.MQTTState;\n\tSwitchTrigger:R_TRIG;\nEND_VAR\n\nIF NOT MyInit THEN\n\tMyInit := TRUE;\n\tSUPER^();\n\t//this is for transmitting the lamp state\n\t(*SendState.Init(\n\tState:= ADR(LampOut), \n\tTopic:= ADR(MyTopicSend), \n\tStateName:= ADR(''), \n\tStateValueOn:= ADR('Lamp switched On'), \n\tStateValueOff:= ADR('Lamp switched Off'), \n\tMQTT_IN_OUT REF= GVL_MQTT.MQTT_IN_OUT, \n\tQoS:= SD_MQTT.QoS.ExactlyOnce,\n\tRetainMqtt:= TRUE);*)\n\tMyProperty.Collector.put(instance:= THIS^);\n", "title": "GreatExampleOfAdvantages-FUN\\LampBase.st"}, {"text": "{attribute 'qualified_only'}\nVAR_GLOBAL\n\tMQTT_IN_OUT:MQTT.MQTT_IN_OUT;\nEND_VAR", "title": "GreatExampleOfAdvantages-global\\GVL_MQTT.st"}, {"text": "VAR\n\t//Client:SD_MQTT.HANDLE_MQTT;\n\t\n\tSubscriber:MQTT.MQTTSubscribe;\n\tinit: BOOL;\n\tInstanceName:CommonTypesAndFunctions.GetInstanceName;\n\tSubscribeTopic:STRING(255);\n\tbirthTopic:STRING(255);\n\tfound:DINT;\n\tpt:POINTER TO STRING;\n\tbirthMessage:MQTT.MQTTPublish;\n\tconnectRising:R_TRIG;\n\txxx:POINTER TO STRING;\nEND_VAR\n\nIF NOT init THEN\n\tinit := TRUE;\n\tSubscriber.SetMqttInOut(MQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT);\n\tSubscribeTopic := InstanceName.GetInstanceTopic();\n\tbirthTopic := SubscribeTopic;\n\tfound := CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic), str2:= ADR('/'));\n\tfound := found + 1 + CommonTypesAndFunctions.find(str1:= ADR(SubscribeTopic[found + 1]), str2:= ADR('/'));\n\tpt := ADR(SubscribeTopic[found  + 1]);\n\tpt^ := 'Receive/#'; \n\tGVL_MQTT.MQTT_IN_OUT.ClientID := CONCAT('CodesysMqtt',TO_STRING(TICKS.GetTick(xDummy:= TRUE)));\nEND_IF\n\n\nGVL_MQTT.MQTT_IN_OUT.clientFB( \n\tMQTT_IN_OUT:= GVL_MQTT.MQTT_IN_OUT, \n\tENABLE:= TRUE, \n\tURL:= 'broker.hivemq.com:1883', \n\tTIMEOUT:= T#8S);\n\t\nSubscriber(\n\tSubscribe:= TRUE, \n\tTopic:= ADR(SubscribeTopic), \n\tQoSSubscribe:= MQTT.QoS.ExactlyOnce, \n\tExpectingString:= TRUE, \n\tCallback:= MyProperty.Collector);\n\t\nconnectRising(CLK:= GVL_MQTT.MQTT_IN_OUT.BROKER_CONNECTED);\n\n\tbirthMessage(\n\tTopic:= ADR(birthTopic), \n\tPayloadString:= ADR('born'), \n\tPublishAsString:= TRUE,\n\tQoSIn:= MQTT.QoS.ExactlyOnce , \n\tMRetain:= FALSE, \n\tsend:= connectRising.Q);\n", "title": "GreatExampleOfAdvantages-FUN\\MQTT_STUFF.st"}, {"text": "\nMETHOD PublishReceived : BOOL\nVAR_INPUT\n\t(*Collection of received Data*)\n\tData\t: MQTT.CALLBACK_DATA;\n\ttempIn:REAL;\nEND_VAR\nVAR_OUTPUT\nEND_VAR\nVAR\n\tMyInit: BOOL;\n\tSendTemp:MQTT.MQTTValue;\n\tdelimiter:BYTE;\n\tstartValue:CommonTypesAndFunctions.ALL_TYPES_UNION;\n\tSetPoint:MQTT.ReceiveValue;\n\tSendPointer:CommonTypesAndFunctions.ALL_TYPES_UNION_POINTER;\n\t\nEND_VAR\n\n\n//check if the packet is for me\n\n\nPublishReceived := SetPoint.PublishReceived(Data:= Data);", "title": "GreatExampleOfAdvantages-FUN\\TemperatureBase_PublishReceived.st"}], "task_id": "MQTT_STUFF"}
