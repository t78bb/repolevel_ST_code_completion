{"requirement": "\u8fd9\u4e2a\u4ee3\u7801\u610f\u5728\u5b9e\u73b0\u4ece\u6307\u5b9a\u8def\u5f84\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5e76\u5c06\u5176\u5b58\u50a8\u5230\u7f13\u51b2\u533a\u7684\u529f\u80fd\u3002", "provide_code": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR", "docs": [{"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbDone := TRUE;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbDone := TRUE;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "VAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbDone := TRUE;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\nEND_CASE", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbDone := TRUE;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\nEND_CASE", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}], "task_id": "ReadFile"}
{"requirement": "\u8fd9\u4e2a\u4ee3\u7801\u610f\u5728\u5b9e\u73b0\u5c06\u6307\u5b9a\u7f13\u51b2\u533a\u7684\u6570\u636e\u5199\u5165\u5230\u6307\u5b9a\u8def\u5f84\u6587\u4ef6\u7684\u529f\u80fd\u3002", "provide_code": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR", "docs": [{"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK WriteFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\twriteBuffer\t:\tARRAY[0..255] OF BYTE;//\u5199\u6570\u7f13\u51b2\u533a\n\twriteNum\t:\tUDINT;//\u5199\u5165\u6570\u636e\u7684\u5b57\u8282\u6570\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "FUNCTION_BLOCK ReadFile\nVAR_INPUT\n\tbExec\t:\tBOOL;//\u529f\u80fd\u5757\u89e6\u53d1\u53d8\u91cf\n\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "\tfileName\t:\tSTRING;//\u6587\u4ef6\u7684\u8def\u5f84\nEND_VAR\nVAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbDone := TRUE;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "\tnNumWrite\t:\tUDINT;//\u5199\u5165\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_WRITE,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumWrite := SysFileWrite(hFile := fileHandle,pbyBuffer := ADR(writeBuffer),ulSize := writeNum,pResult := ADR(nErrId));\n\t\tIF (nNumWrite <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbDone := TRUE;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\nEND_CASE", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\WriteFile.st"}, {"text": "VAR\n\tnState\t:\tBYTE;\n\tfileHandle\t:\tUDINT;//\u6587\u4ef6\u53e5\u67c4\n\ti\t:\tBYTE;//\u5b9a\u4e49\u5faa\u73af\u53d8\u91cf\n\t\n\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbDone := TRUE;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "\tfbRtrig\t:\tR_TRIG;//\u5b9e\u4f8b\u5316\u4e0a\u5347\u6cbf\u89e6\u53d1\u529f\u80fd\u5757\nEND_VAR\nVAR_OUTPUT\n\tReadBuffer\t:\tARRAY[0..255] OF BYTE;//\u8bfb\u6570\u7f13\u51b2\u533a\n\tnNumRead\t:\tUDINT;//\u8bfb\u53d6\u6587\u4ef6\u7684\u5b57\u8282\u6570\n\tbDone\t:\tBOOL;//\u5199\u5165\u6210\u529f\n\tbBusy\t:\tBOOL;//\u5199\u5165\u5fd9\n\tbErr\t:\tBOOL;//\u5199\u5165\u51fa\u9519\n\tnErrId\t:\tUDINT;//\u9519\u8bef\u4ee3\u7801\nEND_VAR\n\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}, {"text": "\nCASE nState OF\n\t0:\n\t\tfbRtrig(CLK := bExec);//\u7b49\u5f85\u7528\u6237\u89e6\u53d1\u8c03\u7528\n\t\tIF fbRtrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tnNumRead := 0;\n\t\t\tbBusy := TRUE;\n\t\t\tbErr := FALSE;\n\t\t\tnErrId := 0;\n\t\t\tbDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\t//\u6253\u5f00\u6587\u4ef6\n\t\tfileHandle := SysFileOpen(szFile := fileName,am := AM_READ,pResult := ADR(nErrId));\n\t\tIF (fileHandle <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t2:\n\t\t//\u5199\u6570\u636e\u5230\u6587\u4ef6\n\t\tnNumRead := SysFileRead(hFile := fileHandle,pbyBuffer := ADR(ReadBuffer),ulSize := SIZEOF(ReadBuffer),pResult := ADR(nErrId));\n\t\tIF (nNumRead <> 0) AND (nErrId = 0) THEN\n\t\t\tnState := 3;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\n\t3:\n\t\t//\u5173\u95ed\u6587\u4ef6\n\t\tnErrId := SysFileClose(hFile := fileHandle);\n\t\tIF nErrId = 0 THEN\n\t\t\tfileHandle := 0;\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbDone := TRUE;\n\t\tEND_IF\n\t\tIF nErrId <> 0 THEN\n\t\t\tnState := 0;\n\t\t\tbBusy := FALSE;\n\t\t\tbErr := TRUE; \n\t\tEND_IF\nEND_CASE", "title": "\u8bfb\u5199\u6587\u4ef6-FUN\\ReadFile.st"}], "task_id": "WriteFile"}
