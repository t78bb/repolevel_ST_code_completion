{"_id": "电子凸轮运动实训/0", "text": "FUNCTION_BLOCK FB_DualAxisPower\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t\t//轴1引用\n\tAxis2\t\t\t:\tAXIS_REF;\t\t\t//轴2引用\n\tbPowerOn\t\t:\tBOOL;\t\t\t\t//电源使能信号\nEND_VAR\nVAR_OUTPUT\n\tbPowerDone\t\t:\tBOOL;\t\t\t\t//两轴都准备就绪\n\tbAxis1Ready\t\t:\tBOOL;\t\t\t\t//轴1准备就绪\n\tbAxis2Ready\t\t:\tBOOL;\t\t\t\t//轴2准备就绪\n\tbError\t\t\t:\tBOOL;\t\t\t\t//错误标志\nEND_VAR", "metadata": {"task_id": "电子凸轮运动实训/0", "ground_truth": "FUNCTION_BLOCK FB_DualAxisPower\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t\t//轴1引用\n\tAxis2\t\t\t:\tAXIS_REF;\t\t\t//轴2引用\n\tbPowerOn\t\t:\tBOOL;\t\t\t\t//电源使能信号\nEND_VAR\nVAR_OUTPUT\n\tbPowerDone\t\t:\tBOOL;\t\t\t\t//两轴都准备就绪\n\tbAxis1Ready\t\t:\tBOOL;\t\t\t\t//轴1准备就绪\n\tbAxis2Ready\t\t:\tBOOL;\t\t\t\t//轴2准备就绪\n\tbError\t\t\t:\tBOOL;\t\t\t\t//错误标志\nEND_VAR\nVAR\n\tfbPower1\t\t:\tMC_Power;\t\t\t//轴1电源控制\n\tfbPower2\t\t:\tMC_Power;\t\t\t//轴2电源控制\nEND_VAR\n\n// 执行轴1电源控制\nfbPower1(\n\tAxis := Axis1,\n\tEnable := TRUE,\n\tbDriveStart := bPowerOn,\n\tbRegulatorOn := bPowerOn\n);\n\n// 执行轴2电源控制\nfbPower2(\n\tAxis := Axis2,\n\tEnable := TRUE,\n\tbDriveStart := bPowerOn,\n\tbRegulatorOn := bPowerOn\n);\n\n// 更新输出状态\nbAxis1Ready := fbPower1.Status;\nbAxis2Ready := fbPower2.Status;\nbPowerDone := fbPower1.Status AND fbPower2.Status;\nbError := fbPower1.Error OR fbPower2.Error;", "fpath_tuple": ["FUN", "FB_DualAxisPower.st"], "context_start_lineno": 0, "lineno": 13, "function_name": "FB_DualAxisPower", "line_no": 13}}
{"_id": "电子凸轮运动实训/1", "text": "FUNCTION_BLOCK FB_DualAxisReset\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t\t//轴1引用\n\tAxis2\t\t\t:\tAXIS_REF;\t\t\t//轴2引用\n\tbExecute\t\t:\tBOOL;\t\t\t\t//执行复位信号\nEND_VAR\nVAR_OUTPUT\n\tbDone\t\t\t:\tBOOL;\t\t\t\t//复位完成\n\tbBusy\t\t\t:\tBOOL;\t\t\t\t//复位进行中\n\tbError\t\t\t:\tBOOL;\t\t\t\t//错误标志\nEND_VAR", "metadata": {"task_id": "电子凸轮运动实训/1", "ground_truth": "FUNCTION_BLOCK FB_DualAxisReset\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t\t//轴1引用\n\tAxis2\t\t\t:\tAXIS_REF;\t\t\t//轴2引用\n\tbExecute\t\t:\tBOOL;\t\t\t\t//执行复位信号\nEND_VAR\nVAR_OUTPUT\n\tbDone\t\t\t:\tBOOL;\t\t\t\t//复位完成\n\tbBusy\t\t\t:\tBOOL;\t\t\t\t//复位进行中\n\tbError\t\t\t:\tBOOL;\t\t\t\t//错误标志\nEND_VAR\nVAR\n\tfbReset1\t\t:\tMC_Reset;\t\t\t//轴1复位\n\tfbReset2\t\t:\tMC_Reset;\t\t\t//轴2复位\n\tfbReadStatus1\t:\tMC_ReadStatus;\t\t//轴1状态读取\n\tfbReadStatus2\t:\tMC_ReadStatus;\t\t//轴2状态读取\n\tbError1\t\t\t:\tBOOL;\t\t\t\t//轴1错误标志\n\tbError2\t\t\t:\tBOOL;\t\t\t\t//轴2错误标志\n\tnState\t\t\t:\tUDINT;\t\t\t\t//状态机\nEND_VAR\n\nCASE nState OF \n\t0: (* 空闲状态 *)\n\t\tbDone := FALSE;\n\t\tbBusy := FALSE;\n\t\t\n\t\tIF bExecute THEN\n\t\t\t// 初始化\n\t\t\tfbReset1(Axis := Axis1, Execute := FALSE);\n\t\t\tfbReset2(Axis := Axis2, Execute := FALSE);\n\t\t\tfbReadStatus1(Axis := Axis1, Enable := FALSE);\n\t\t\tfbReadStatus2(Axis := Axis2, Enable := FALSE);\n\t\t\tnState := 1;\n\t\tEND_IF\n\t\t\n\t1: (* 读取轴状态 *)\n\t\tbBusy := TRUE;\n\t\t\n\t\tfbReadStatus1(Axis := Axis1, Enable := TRUE);\n\t\tfbReadStatus2(Axis := Axis2, Enable := TRUE);\n\t\t\n\t\tIF fbReadStatus1.Valid AND fbReadStatus2.Valid THEN\n\t\t\tbError1 := fbReadStatus1.Errorstop;\n\t\t\tbError2 := fbReadStatus2.Errorstop;\n\t\t\tfbReadStatus1(Axis := Axis1, Enable := FALSE);\n\t\t\tfbReadStatus2(Axis := Axis2, Enable := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: (* 执行复位 *)\n\t\tfbReset1(Axis := Axis1, Execute := TRUE);\n\t\tfbReset2(Axis := Axis2, Execute := TRUE);\n\t\tfbReadStatus1(Axis := Axis1, Enable := TRUE);\n\t\tfbReadStatus2(Axis := Axis2, Enable := TRUE);\n\t\t\n\t\tIF fbReadStatus1.Valid AND fbReadStatus2.Valid THEN\n\t\t\tbError1 := fbReadStatus1.Errorstop;\n\t\t\tbError2 := fbReadStatus2.Errorstop;\n\t\t\tfbReadStatus1(Axis := Axis1, Enable := FALSE);\n\t\t\tfbReadStatus2(Axis := Axis2, Enable := FALSE);\n\t\t\t\n\t\t\t// 检查是否还有错误\n\t\t\tIF NOT bError1 AND NOT bError2 THEN\n\t\t\t\tbDone := TRUE;\n\t\t\t\tbBusy := FALSE;\n\t\t\t\tnState := 3;\n\t\t\tELSE\n\t\t\t\tbError := TRUE;\n\t\t\t\tbBusy := FALSE;\n\t\t\t\tnState := 3;\n\t\t\tEND_IF\n\t\tEND_IF\n\t\t\n\t3: (* 完成状态 *)\n\t\tIF NOT bExecute THEN\n\t\t\tbDone := FALSE;\n\t\t\tbError := FALSE;\n\t\t\tnState := 0;\n\t\tEND_IF\nEND_CASE", "fpath_tuple": ["FUN", "FB_DualAxisReset.st"], "context_start_lineno": 0, "lineno": 12, "function_name": "FB_DualAxisReset", "line_no": 12}}
{"_id": "电子凸轮运动实训/2", "text": "FUNCTION F_AxisStatusToString : STRING\nVAR_INPUT\n\tfbReadStatus\t:\tMC_ReadStatus;\t\t//轴状态读取功能块\nEND_VAR", "metadata": {"task_id": "电子凸轮运动实训/2", "ground_truth": "FUNCTION F_AxisStatusToString : STRING\nVAR_INPUT\n\tfbReadStatus\t:\tMC_ReadStatus;\t\t//轴状态读取功能块\nEND_VAR\n\n// 根据轴状态返回对应的字符串描述\n// 按优先级顺序检查状态\n\nIF fbReadStatus.Errorstop THEN\n\tF_AxisStatusToString := 'Errorstop';\n\tRETURN;\nEND_IF\n\nIF fbReadStatus.Disabled THEN\n\tF_AxisStatusToString := 'Disabled';\n\tRETURN;\nEND_IF\n\nIF fbReadStatus.Homing THEN\n\tF_AxisStatusToString := 'Homing';\n\tRETURN;\nEND_IF\n\nIF fbReadStatus.Stopping THEN\n\tF_AxisStatusToString := 'Stopping';\n\tRETURN;\nEND_IF\n\nIF fbReadStatus.SynchronizedMotion THEN\n\tF_AxisStatusToString := 'SynchronizedMotion';\n\tRETURN;\nEND_IF\n\nIF fbReadStatus.ContinuousMotion THEN\n\tF_AxisStatusToString := 'ContinuousMotion';\n\tRETURN;\nEND_IF\n\nIF fbReadStatus.DiscreteMotion THEN\n\tF_AxisStatusToString := 'DiscreteMotion';\n\tRETURN;\nEND_IF\n\nIF fbReadStatus.StandStill THEN\n\tF_AxisStatusToString := 'StandStill';\n\tRETURN;\nEND_IF\n\n// 默认状态\nF_AxisStatusToString := 'Unknown';", "fpath_tuple": ["FUN", "F_AxisStatusToString.st"], "context_start_lineno": 0, "lineno": 5, "function_name": "F_AxisStatusToString", "line_no": 5}}
{"_id": "电子凸轮运动实训/3", "text": "FUNCTION_BLOCK ResetAxis\nVAR_INPUT \n\tbExec\t:\tBOOL;\nEND_VAR", "metadata": {"task_id": "电子凸轮运动实训/3", "ground_truth": "FUNCTION_BLOCK ResetAxis\nVAR_INPUT \n\tbExec\t:\tBOOL;\nEND_VAR\nVAR\n\tfbReset1\t:\tMC_Reset;\n\tfbReset2\t:\tMC_Reset;\n\t\n\tfbReadAxisError1\t:\tMC_ReadAxisError;\n\tfbReadAxisError2\t:\tMC_ReadAxisError;\n\t\n\tfbReadStatus1\t:\tMC_ReadStatus;\n\tfbReadStatus2\t:\tMC_ReadStatus;\n\t\n\tfbExecTrig\t:\tR_TRIG;\n\tnState \t:\tBYTE;\n\t\n\tbErrorX\t:\tBOOL;\n\tbErrorY\t:\tBOOL;\n\t\nEND_VAR\n\nVAR_OUTPUT \n\tDone\t:\tBOOL;\nEND_VAR\n\nfbExecTrig(CLK := bExec);\n\nCASE nState OF \n\t0:\n\t\tIF fbExecTrig.Q THEN\n\t\t\tnState := 1;\n\t\t\tDone := FALSE;\n\t\tEND_IF\n\t1:\n\t\tfbReadAxisError1(Axis := AxisX ,Enable := TRUE);\n\t\tfbReadAxisError2(Axis := AxisY ,Enable := TRUE);\n\t\t\n\t\tfbReadStatus1(Axis := AxisX ,Enable := TRUE);\n\t\tfbReadStatus2(Axis := AxisY ,Enable := TRUE);\n\t\t\n\t\tIF fbReadAxisError1.Valid AND fbReadAxisError2.Valid AND fbReadStatus1.Valid AND fbReadStatus2.Valid THEN\n\t\t\tIF fbReadAxisError1.AxisError OR fbReadStatus1.FBErrorOccured THEN\n\t\t\t\tbErrorX := TRUE;\n\t\t\tELSE\n\t\t\t\tbErrorX := FALSE;\n\t\t\tEND_IF\n\t\t\tIF fbReadAxisError2.AxisError OR fbReadStatus2.FBErrorOccured THEN\n\t\t\t\tbErrorY := TRUE;\n\t\t\tELSE\n\t\t\t\tbErrorY := FALSE;\n\t\t\tEND_IF\n\t\t\tfbReadAxisError1(Axis := AxisX ,Enable := FALSE);\n\t\t\tfbReadAxisError2(Axis := AxisY ,Enable := FALSE);\n\t\t\t\n\t\t\tfbReadStatus1(Axis := AxisX ,Enable := FALSE);\n\t\t\tfbReadStatus2(Axis := AxisY ,Enable := FALSE);\n\t\t\t\n\t\t\tfbReset1(Axis := AxisX,Execute := FALSE);\n\t\t\tfbReset2(Axis := AxisY,Execute := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t2:\n\t\tfbReset1(Axis := AxisX,Execute := bErrorX);\n\t\tfbReset2(Axis := AxisY,Execute := bErrorY);\n\t\t\n\t\tfbReadAxisError1(Axis := AxisX ,Enable := TRUE);\n\t\tfbReadAxisError2(Axis := AxisY ,Enable := TRUE);\n\t\t\n\t\tfbReadStatus1(Axis := AxisX ,Enable := TRUE);\n\t\tfbReadStatus2(Axis := AxisY ,Enable := TRUE);\n\t\t\n\t\tIF fbReadAxisError1.Valid AND fbReadAxisError2.Valid AND fbReadStatus1.Valid AND fbReadStatus2.Valid THEN\n\t\t\tIF NOT fbReadAxisError1.AxisError AND NOT fbReadAxisError2.AxisError (* AND NOT fbReadStatus1.FBErrorOccured AND NOT fbReadStatus2.FBErrorOccured AND NOT fbReadStatus3.FBErrorOccured *)THEN\n\t\t\t\tnState := 0;\n\t\t\t\tDone := TRUE;\n\t\t\t\t\n\t\t\t\tfbReadAxisError1(Axis := AxisX ,Enable := FALSE);\n\t\t\t\tfbReadAxisError2(Axis := AxisY ,Enable := FALSE);\n\t\t\t\t\n\t\t\t\tfbReset1(Axis := AxisX,Execute := FALSE);\n\t\t\t\tfbReset2(Axis := AxisY,Execute := FALSE);\n\t\t\t\t\n\t\t\t\tfbReadStatus1(Axis := AxisX ,Enable := FALSE);\n\t\t\t\tfbReadStatus2(Axis := AxisY ,Enable := FALSE);\n\t\t\tEND_IF\n\t\tEND_IF\nEND_CASE", "fpath_tuple": ["FUN", "ResetAxis.st"], "context_start_lineno": 0, "lineno": 5, "function_name": "ResetAxis", "line_no": 5}}
