{"_id": "elevator_FUN_FB_ElevatorDoorController.st_0-25", "title": "elevator-FUN\\FB_ElevatorDoorController.st", "text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// 到达目标楼层\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// 门已关闭传感器\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// 开门命令\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// 关门命令\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// 门打开状态\n\tbDoorReady\t\t\t:\tBOOL;\t\t// 门准备好（可以移动）\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// 开门延时定时器\n\tfbCloseDoorTimer\t:\tTON;\t\t// 关门延时定时器\n\tnState\t\t\t\t:\tINT;\t\t// 状态机\nEND_VAR\n\nCASE nState OF\n\t0: // 空闲状态\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // 开始开门流程\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorDoorController.st"], "repo": "elevator", "line_no": 0, "start_line_no": 0, "end_line_no": 25, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorDoorController.st_0-30", "title": "elevator-FUN\\FB_ElevatorDoorController.st", "text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// 到达目标楼层\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// 门已关闭传感器\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// 开门命令\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// 关门命令\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// 门打开状态\n\tbDoorReady\t\t\t:\tBOOL;\t\t// 门准备好（可以移动）\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// 开门延时定时器\n\tfbCloseDoorTimer\t:\tTON;\t\t// 关门延时定时器\n\tnState\t\t\t\t:\tINT;\t\t// 状态机\nEND_VAR\n\nCASE nState OF\n\t0: // 空闲状态\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // 开始开门流程\n\t\tEND_IF\n\t\t\n\t1: // 开门延时\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorDoorController.st"], "repo": "elevator", "line_no": 5, "start_line_no": 0, "end_line_no": 30, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorDoorController.st_0-35", "title": "elevator-FUN\\FB_ElevatorDoorController.st", "text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// 到达目标楼层\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// 门已关闭传感器\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// 开门命令\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// 关门命令\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// 门打开状态\n\tbDoorReady\t\t\t:\tBOOL;\t\t// 门准备好（可以移动）\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// 开门延时定时器\n\tfbCloseDoorTimer\t:\tTON;\t\t// 关门延时定时器\n\tnState\t\t\t\t:\tINT;\t\t// 状态机\nEND_VAR\n\nCASE nState OF\n\t0: // 空闲状态\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // 开始开门流程\n\t\tEND_IF\n\t\t\n\t1: // 开门延时\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorDoorController.st"], "repo": "elevator", "line_no": 10, "start_line_no": 0, "end_line_no": 35, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorDoorController.st_0-40", "title": "elevator-FUN\\FB_ElevatorDoorController.st", "text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// 到达目标楼层\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// 门已关闭传感器\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// 开门命令\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// 关门命令\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// 门打开状态\n\tbDoorReady\t\t\t:\tBOOL;\t\t// 门准备好（可以移动）\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// 开门延时定时器\n\tfbCloseDoorTimer\t:\tTON;\t\t// 关门延时定时器\n\tnState\t\t\t\t:\tINT;\t\t// 状态机\nEND_VAR\n\nCASE nState OF\n\t0: // 空闲状态\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // 开始开门流程\n\t\tEND_IF\n\t\t\n\t1: // 开门延时\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // 开门\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorDoorController.st"], "repo": "elevator", "line_no": 15, "start_line_no": 0, "end_line_no": 40, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorDoorController.st_0-45", "title": "elevator-FUN\\FB_ElevatorDoorController.st", "text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// 到达目标楼层\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// 门已关闭传感器\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// 开门命令\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// 关门命令\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// 门打开状态\n\tbDoorReady\t\t\t:\tBOOL;\t\t// 门准备好（可以移动）\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// 开门延时定时器\n\tfbCloseDoorTimer\t:\tTON;\t\t// 关门延时定时器\n\tnState\t\t\t\t:\tINT;\t\t// 状态机\nEND_VAR\n\nCASE nState OF\n\t0: // 空闲状态\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // 开始开门流程\n\t\tEND_IF\n\t\t\n\t1: // 开门延时\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // 开门\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // 等待开始关门\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // 开始关门流程\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorDoorController.st"], "repo": "elevator", "line_no": 20, "start_line_no": 0, "end_line_no": 45, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorDoorController.st_0-50", "title": "elevator-FUN\\FB_ElevatorDoorController.st", "text": "FUNCTION_BLOCK FB_ElevatorDoorController\nVAR_INPUT\n\tbArrivedAtTarget\t:\tBOOL;\t\t// 到达目标楼层\n\tbDoorClosed\t\t\t:\tBOOL;\t\t// 门已关闭传感器\nEND_VAR\nVAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// 开门命令\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// 关门命令\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// 门打开状态\n\tbDoorReady\t\t\t:\tBOOL;\t\t// 门准备好（可以移动）\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// 开门延时定时器\n\tfbCloseDoorTimer\t:\tTON;\t\t// 关门延时定时器\n\tnState\t\t\t\t:\tINT;\t\t// 状态机\nEND_VAR\n\nCASE nState OF\n\t0: // 空闲状态\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // 开始开门流程\n\t\tEND_IF\n\t\t\n\t1: // 开门延时\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // 开门\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // 等待开始关门\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // 开始关门流程\n\t\tEND_IF\n\t\t\n\t4: // 关门\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorDoorController.st"], "repo": "elevator", "line_no": 25, "start_line_no": 0, "end_line_no": 50, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorDoorController.st_5-55", "title": "elevator-FUN\\FB_ElevatorDoorController.st", "text": "VAR_OUTPUT\n\tbOpenDoor\t\t\t:\tBOOL;\t\t// 开门命令\n\tbCloseDoor\t\t\t:\tBOOL;\t\t// 关门命令\n\tbDoorOpen\t\t\t:\tBOOL;\t\t// 门打开状态\n\tbDoorReady\t\t\t:\tBOOL;\t\t// 门准备好（可以移动）\nEND_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// 开门延时定时器\n\tfbCloseDoorTimer\t:\tTON;\t\t// 关门延时定时器\n\tnState\t\t\t\t:\tINT;\t\t// 状态机\nEND_VAR\n\nCASE nState OF\n\t0: // 空闲状态\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // 开始开门流程\n\t\tEND_IF\n\t\t\n\t1: // 开门延时\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // 开门\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // 等待开始关门\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // 开始关门流程\n\t\tEND_IF\n\t\t\n\t4: // 关门\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n\t\tbDoorOpen := FALSE;\n\t\tfbCloseDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbCloseDoorTimer.Q AND bDoorClosed THEN\n\t\t\tfbCloseDoorTimer(IN := FALSE);\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorDoorController.st"], "repo": "elevator", "line_no": 5, "start_line_no": 5, "end_line_no": 55, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorDoorController.st_10-59", "title": "elevator-FUN\\FB_ElevatorDoorController.st", "text": "END_VAR\nVAR\n\tfbDoorTimer\t\t\t:\tTON;\t\t// 开门延时定时器\n\tfbCloseDoorTimer\t:\tTON;\t\t// 关门延时定时器\n\tnState\t\t\t\t:\tINT;\t\t// 状态机\nEND_VAR\n\nCASE nState OF\n\t0: // 空闲状态\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := TRUE;\n\t\t\n\t\tIF bArrivedAtTarget THEN\n\t\t\tnState := 1; // 开始开门流程\n\t\tEND_IF\n\t\t\n\t1: // 开门延时\n\t\tbCloseDoor := FALSE;\n\t\tbDoorReady := FALSE;\n\t\tfbDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbDoorTimer.Q THEN\n\t\t\tfbDoorTimer(IN := FALSE);\n\t\t\tnState := 2;\n\t\tEND_IF\n\t\t\n\t2: // 开门\n\t\tbOpenDoor := TRUE;\n\t\tbDoorOpen := TRUE;\n\t\tnState := 3;\n\t\t\n\t3: // 等待开始关门\n\t\tIF NOT bArrivedAtTarget THEN\n\t\t\tnState := 4; // 开始关门流程\n\t\tEND_IF\n\t\t\n\t4: // 关门\n\t\tbOpenDoor := FALSE;\n\t\tbCloseDoor := TRUE;\n\t\tbDoorOpen := FALSE;\n\t\tfbCloseDoorTimer(IN := TRUE, PT := T#2S);\n\t\t\n\t\tIF fbCloseDoorTimer.Q AND bDoorClosed THEN\n\t\t\tfbCloseDoorTimer(IN := FALSE);\n\t\t\tnState := 0; // 返回空闲\n\t\tEND_IF\nEND_CASE\n\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorDoorController.st"], "repo": "elevator", "line_no": 10, "start_line_no": 10, "end_line_no": 59, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_0-25", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// 当前楼层\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// 门准备好\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// 目标楼层数组\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// 向上移动\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// 向下移动\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// 到达目标楼层\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// 移动延时定时器\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// 循环变量\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// 有更高楼层请求\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// 有更低楼层请求\nEND_VAR\n\n// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 0, "start_line_no": 0, "end_line_no": 25, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_0-30", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// 当前楼层\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// 门准备好\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// 目标楼层数组\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// 向上移动\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// 向下移动\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// 到达目标楼层\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// 移动延时定时器\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// 循环变量\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// 有更高楼层请求\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// 有更低楼层请求\nEND_VAR\n\n// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 5, "start_line_no": 0, "end_line_no": 30, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_0-35", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// 当前楼层\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// 门准备好\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// 目标楼层数组\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// 向上移动\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// 向下移动\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// 到达目标楼层\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// 移动延时定时器\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// 循环变量\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// 有更高楼层请求\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// 有更低楼层请求\nEND_VAR\n\n// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 10, "start_line_no": 0, "end_line_no": 35, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_0-40", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// 当前楼层\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// 门准备好\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// 目标楼层数组\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// 向上移动\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// 向下移动\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// 到达目标楼层\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// 移动延时定时器\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// 循环变量\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// 有更高楼层请求\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// 有更低楼层请求\nEND_VAR\n\n// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 15, "start_line_no": 0, "end_line_no": 40, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_0-45", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// 当前楼层\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// 门准备好\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// 目标楼层数组\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// 向上移动\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// 向下移动\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// 到达目标楼层\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// 移动延时定时器\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// 循环变量\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// 有更高楼层请求\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// 有更低楼层请求\nEND_VAR\n\n// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 20, "start_line_no": 0, "end_line_no": 45, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_0-50", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "FUNCTION_BLOCK FB_ElevatorMovement\nVAR_INPUT\n\tCurrentFloor\t\t:\tINT;\t\t\t\t// 当前楼层\n\tbDoorReady\t\t\t:\tBOOL;\t\t\t\t// 门准备好\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// 目标楼层数组\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// 向上移动\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// 向下移动\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// 到达目标楼层\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// 移动延时定时器\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// 循环变量\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// 有更高楼层请求\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// 有更低楼层请求\nEND_VAR\n\n// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 25, "start_line_no": 0, "end_line_no": 50, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_5-55", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "VAR_IN_OUT\n\tTargetFloors\t\t:\tARRAY[0..3] OF BOOL;\t// 目标楼层数组\nEND_VAR\nVAR_OUTPUT\n\tbMovingUp\t\t\t:\tBOOL;\t\t\t\t// 向上移动\n\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// 向下移动\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// 到达目标楼层\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// 移动延时定时器\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// 循环变量\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// 有更高楼层请求\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// 有更低楼层请求\nEND_VAR\n\n// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 5, "start_line_no": 5, "end_line_no": 55, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_10-60", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "\tbMovingDown\t\t\t:\tBOOL;\t\t\t\t// 向下移动\n\tbArrivedAtTarget\t:\tBOOL;\t\t\t\t// 到达目标楼层\nEND_VAR\nVAR\n\tfbMoveDelayTimer\t:\tTON;\t\t\t\t// 移动延时定时器\n\ti\t\t\t\t\t:\tINT;\t\t\t\t// 循环变量\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// 有更高楼层请求\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// 有更低楼层请求\nEND_VAR\n\n// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// 向上移动\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 10, "start_line_no": 10, "end_line_no": 60, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_15-65", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "\ti\t\t\t\t\t:\tINT;\t\t\t\t// 循环变量\n\tbHasUpperRequest\t:\tBOOL;\t\t\t\t// 有更高楼层请求\n\tbHasLowerRequest\t:\tBOOL;\t\t\t\t// 有更低楼层请求\nEND_VAR\n\n// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// 向上移动\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 15, "start_line_no": 15, "end_line_no": 65, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_20-70", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "// 检查是否到达目标楼层\nIF TargetFloors[CurrentFloor] THEN\n\tbArrivedAtTarget := TRUE;\n\tTargetFloors[CurrentFloor] := FALSE; // 清除请求\n\tbMovingUp := FALSE;\n\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// 向上移动\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更高请求，改变方向\n\t\tbMovingUp := FALSE;\n\t\tIF bHasLowerRequest THEN\n\t\t\tbMovingDown := TRUE;\n\t\tEND_IF\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 20, "start_line_no": 20, "end_line_no": 70, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_25-75", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "\tbMovingDown := FALSE;\n\tRETURN;\nELSE\n\tbArrivedAtTarget := FALSE;\nEND_IF\n\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// 向上移动\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更高请求，改变方向\n\t\tbMovingUp := FALSE;\n\t\tIF bHasLowerRequest THEN\n\t\t\tbMovingDown := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSIF bMovingDown OR (NOT bMovingUp AND bHasLowerRequest) THEN\n\t// 向下移动\n\tIF bHasLowerRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 25, "start_line_no": 25, "end_line_no": 75, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_30-80", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "\n// 只有门准备好才能移动\nIF NOT bDoorReady THEN\n\tRETURN;\nEND_IF\n\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// 向上移动\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更高请求，改变方向\n\t\tbMovingUp := FALSE;\n\t\tIF bHasLowerRequest THEN\n\t\t\tbMovingDown := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSIF bMovingDown OR (NOT bMovingUp AND bHasLowerRequest) THEN\n\t// 向下移动\n\tIF bHasLowerRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingDown := TRUE;\n\t\t\tbMovingUp := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 30, "start_line_no": 30, "end_line_no": 80, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_35-85", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "\n// 检查是否有更高楼层的请求\nbHasUpperRequest := FALSE;\nFOR i := CurrentFloor + 1 TO 3 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// 向上移动\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更高请求，改变方向\n\t\tbMovingUp := FALSE;\n\t\tIF bHasLowerRequest THEN\n\t\t\tbMovingDown := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSIF bMovingDown OR (NOT bMovingUp AND bHasLowerRequest) THEN\n\t// 向下移动\n\tIF bHasLowerRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingDown := TRUE;\n\t\t\tbMovingUp := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更低请求，改变方向\n\t\tbMovingDown := FALSE;\n\t\tIF bHasUpperRequest THEN\n\t\t\tbMovingUp := TRUE;\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 35, "start_line_no": 35, "end_line_no": 85, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_40-90", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "\t\tbHasUpperRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// 向上移动\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更高请求，改变方向\n\t\tbMovingUp := FALSE;\n\t\tIF bHasLowerRequest THEN\n\t\t\tbMovingDown := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSIF bMovingDown OR (NOT bMovingUp AND bHasLowerRequest) THEN\n\t// 向下移动\n\tIF bHasLowerRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingDown := TRUE;\n\t\t\tbMovingUp := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更低请求，改变方向\n\t\tbMovingDown := FALSE;\n\t\tIF bHasUpperRequest THEN\n\t\t\tbMovingUp := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSE\n\t// 初始状态，默认向上\n\tIF bHasUpperRequest THEN\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 40, "start_line_no": 40, "end_line_no": 90, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_45-95", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "// 检查是否有更低楼层的请求\nbHasLowerRequest := FALSE;\nFOR i := CurrentFloor - 1 TO 0 BY -1 DO\n\tIF TargetFloors[i] THEN\n\t\tbHasLowerRequest := TRUE;\n\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// 向上移动\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更高请求，改变方向\n\t\tbMovingUp := FALSE;\n\t\tIF bHasLowerRequest THEN\n\t\t\tbMovingDown := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSIF bMovingDown OR (NOT bMovingUp AND bHasLowerRequest) THEN\n\t// 向下移动\n\tIF bHasLowerRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingDown := TRUE;\n\t\t\tbMovingUp := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更低请求，改变方向\n\t\tbMovingDown := FALSE;\n\t\tIF bHasUpperRequest THEN\n\t\t\tbMovingUp := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSE\n\t// 初始状态，默认向上\n\tIF bHasUpperRequest THEN\n\t\tbMovingUp := TRUE;\n\tELSIF bHasLowerRequest THEN\n\t\tbMovingDown := TRUE;\n\tEND_IF\nEND_IF\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 45, "start_line_no": 45, "end_line_no": 95, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_FB_ElevatorMovement.st_50-96", "title": "elevator-FUN\\FB_ElevatorMovement.st", "text": "\t\tEXIT;\n\tEND_IF\nEND_FOR\n\n// 移动逻辑\nIF bMovingUp OR (NOT bMovingDown AND bHasUpperRequest) THEN\n\t// 向上移动\n\tIF bHasUpperRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingUp := TRUE;\n\t\t\tbMovingDown := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更高请求，改变方向\n\t\tbMovingUp := FALSE;\n\t\tIF bHasLowerRequest THEN\n\t\t\tbMovingDown := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSIF bMovingDown OR (NOT bMovingUp AND bHasLowerRequest) THEN\n\t// 向下移动\n\tIF bHasLowerRequest THEN\n\t\tfbMoveDelayTimer(IN := TRUE, PT := T#500MS);\n\t\tIF fbMoveDelayTimer.Q THEN\n\t\t\tbMovingDown := TRUE;\n\t\t\tbMovingUp := FALSE;\n\t\t\tfbMoveDelayTimer(IN := FALSE);\n\t\tEND_IF\n\tELSE\n\t\t// 没有更低请求，改变方向\n\t\tbMovingDown := FALSE;\n\t\tIF bHasUpperRequest THEN\n\t\t\tbMovingUp := TRUE;\n\t\tEND_IF\n\tEND_IF\nELSE\n\t// 初始状态，默认向上\n\tIF bHasUpperRequest THEN\n\t\tbMovingUp := TRUE;\n\tELSIF bHasLowerRequest THEN\n\t\tbMovingDown := TRUE;\n\tEND_IF\nEND_IF\n\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\FB_ElevatorMovement.st"], "repo": "elevator", "line_no": 50, "start_line_no": 50, "end_line_no": 96, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_F_DetectCurrentFloor.st_0-23", "title": "elevator-FUN\\F_DetectCurrentFloor.st", "text": "FUNCTION F_DetectCurrentFloor : INT\nVAR_INPUT\n\tFloorSensor0\t:\tBOOL;\t\t// 0楼传感器\n\tFloorSensor1\t:\tBOOL;\t\t// 1楼传感器\n\tFloorSensor2\t:\tBOOL;\t\t// 2楼传感器\n\tFloorSensor3\t:\tBOOL;\t\t// 3楼传感器\n\tCurrentFloor\t:\tINT;\t\t// 当前楼层（用于保持状态）\nEND_VAR\n\n// 根据传感器输入确定当前楼层\nIF FloorSensor0 THEN \n\tF_DetectCurrentFloor := 0;\nELSIF FloorSensor1 THEN \n\tF_DetectCurrentFloor := 1;\nELSIF FloorSensor2 THEN \n\tF_DetectCurrentFloor := 2;\nELSIF FloorSensor3 THEN \n\tF_DetectCurrentFloor := 3;\nELSE\n\t// 没有传感器信号时，保持当前楼层\n\tF_DetectCurrentFloor := CurrentFloor;\nEND_IF\n\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\F_DetectCurrentFloor.st"], "repo": "elevator", "line_no": 0, "start_line_no": 0, "end_line_no": 23, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_F_RegisterCalls.st_0-25", "title": "elevator-FUN\\F_RegisterCalls.st", "text": "FUNCTION F_RegisterCalls\nVAR_INPUT\n\tCallGround\t\t:\tBOOL;\t\t// 0楼呼叫\n\tCallFloor1\t\t:\tBOOL;\t\t// 1楼呼叫\n\tCallFloor2\t\t:\tBOOL;\t\t// 2楼呼叫\n\tCallFloor3\t\t:\tBOOL;\t\t// 3楼呼叫\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t:\tARRAY[0..3] OF BOOL;\t// 目标楼层数组\nEND_VAR\n\n// 注册各楼层的呼叫请求\nIF CallGround THEN \n\tTargetFloors[0] := TRUE; \nEND_IF\n\nIF CallFloor1 THEN \n\tTargetFloors[1] := TRUE; \nEND_IF\n\nIF CallFloor2 THEN \n\tTargetFloors[2] := TRUE; \nEND_IF\n\nIF CallFloor3 THEN \n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\F_RegisterCalls.st"], "repo": "elevator", "line_no": 0, "start_line_no": 0, "end_line_no": 25, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_F_RegisterCalls.st_0-28", "title": "elevator-FUN\\F_RegisterCalls.st", "text": "FUNCTION F_RegisterCalls\nVAR_INPUT\n\tCallGround\t\t:\tBOOL;\t\t// 0楼呼叫\n\tCallFloor1\t\t:\tBOOL;\t\t// 1楼呼叫\n\tCallFloor2\t\t:\tBOOL;\t\t// 2楼呼叫\n\tCallFloor3\t\t:\tBOOL;\t\t// 3楼呼叫\nEND_VAR\nVAR_IN_OUT\n\tTargetFloors\t:\tARRAY[0..3] OF BOOL;\t// 目标楼层数组\nEND_VAR\n\n// 注册各楼层的呼叫请求\nIF CallGround THEN \n\tTargetFloors[0] := TRUE; \nEND_IF\n\nIF CallFloor1 THEN \n\tTargetFloors[1] := TRUE; \nEND_IF\n\nIF CallFloor2 THEN \n\tTargetFloors[2] := TRUE; \nEND_IF\n\nIF CallFloor3 THEN \n\tTargetFloors[3] := TRUE; \nEND_IF\n\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\F_RegisterCalls.st"], "repo": "elevator", "line_no": 5, "start_line_no": 0, "end_line_no": 28, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_F_UpdateDoorAnimation.st_0-25", "title": "elevator-FUN\\F_UpdateDoorAnimation.st", "text": "FUNCTION F_UpdateDoorAnimation : DINT\nVAR_INPUT\n\tbOpenDoor\t\t:\tBOOL;\t\t// 开门命令\n\tbCloseDoor\t\t:\tBOOL;\t\t// 关门命令\n\tbCallFloor\t\t:\tBOOL;\t\t// 该楼层有呼叫\n\tnCurrentAni\t\t:\tDINT;\t\t// 当前动画值\n\tnMaxAni\t\t\t:\tDINT := 70;\t// 最大动画值\nEND_VAR\nVAR\n\tnNewAni\t\t\t:\tDINT;\t\t// 新的动画值\nEND_VAR\n\nnNewAni := nCurrentAni;\n\n// 开门动画（增加动画值）\nIF bOpenDoor AND nNewAni < nMaxAni AND bCallFloor THEN\n\tnNewAni := nNewAni + 1;\nEND_IF\n\n// 关门动画（减少动画值）\nIF bCloseDoor AND nNewAni > 0 THEN\n\tnNewAni := nNewAni - 1;\nEND_IF\n\nF_UpdateDoorAnimation := nNewAni;\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\F_UpdateDoorAnimation.st"], "repo": "elevator", "line_no": 0, "start_line_no": 0, "end_line_no": 25, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_FUN_F_UpdateDoorAnimation.st_0-26", "title": "elevator-FUN\\F_UpdateDoorAnimation.st", "text": "FUNCTION F_UpdateDoorAnimation : DINT\nVAR_INPUT\n\tbOpenDoor\t\t:\tBOOL;\t\t// 开门命令\n\tbCloseDoor\t\t:\tBOOL;\t\t// 关门命令\n\tbCallFloor\t\t:\tBOOL;\t\t// 该楼层有呼叫\n\tnCurrentAni\t\t:\tDINT;\t\t// 当前动画值\n\tnMaxAni\t\t\t:\tDINT := 70;\t// 最大动画值\nEND_VAR\nVAR\n\tnNewAni\t\t\t:\tDINT;\t\t// 新的动画值\nEND_VAR\n\nnNewAni := nCurrentAni;\n\n// 开门动画（增加动画值）\nIF bOpenDoor AND nNewAni < nMaxAni AND bCallFloor THEN\n\tnNewAni := nNewAni + 1;\nEND_IF\n\n// 关门动画（减少动画值）\nIF bCloseDoor AND nNewAni > 0 THEN\n\tnNewAni := nNewAni - 1;\nEND_IF\n\nF_UpdateDoorAnimation := nNewAni;\n\n", "metadata": [{"fpath_tuple": ["elevator", "FUN\\F_UpdateDoorAnimation.st"], "repo": "elevator", "line_no": 5, "start_line_no": 0, "end_line_no": 26, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_0-25", "title": "elevator-PRG\\PLC_PRG.st", "text": "PROGRAM PLC_PRG\nVAR\n\t// 输入信号\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// 输出信号\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// 内部变量\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// 使用重构后的功能块\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// 门控制器\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// 移动控制器\n\t\n\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 0, "start_line_no": 0, "end_line_no": 25, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_0-30", "title": "elevator-PRG\\PLC_PRG.st", "text": "PROGRAM PLC_PRG\nVAR\n\t// 输入信号\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// 输出信号\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// 内部变量\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// 使用重构后的功能块\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// 门控制器\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// 移动控制器\n\t\n\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 5, "start_line_no": 0, "end_line_no": 30, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_0-35", "title": "elevator-PRG\\PLC_PRG.st", "text": "PROGRAM PLC_PRG\nVAR\n\t// 输入信号\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// 输出信号\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// 内部变量\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// 使用重构后的功能块\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// 门控制器\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// 移动控制器\n\t\n\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 10, "start_line_no": 0, "end_line_no": 35, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_0-40", "title": "elevator-PRG\\PLC_PRG.st", "text": "PROGRAM PLC_PRG\nVAR\n\t// 输入信号\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// 输出信号\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// 内部变量\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// 使用重构后的功能块\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// 门控制器\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// 移动控制器\n\t\n\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 15, "start_line_no": 0, "end_line_no": 40, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_0-45", "title": "elevator-PRG\\PLC_PRG.st", "text": "PROGRAM PLC_PRG\nVAR\n\t// 输入信号\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// 输出信号\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// 内部变量\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// 使用重构后的功能块\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// 门控制器\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// 移动控制器\n\t\n\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 20, "start_line_no": 0, "end_line_no": 45, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_0-50", "title": "elevator-PRG\\PLC_PRG.st", "text": "PROGRAM PLC_PRG\nVAR\n\t// 输入信号\n\tCallGround, CallFloor1, CallFloor2, CallFloor3: BOOL;\n\tFloorSensor0, FloorSensor1, FloorSensor2, FloorSensor3: BOOL;\n\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// 输出信号\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// 内部变量\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// 使用重构后的功能块\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// 门控制器\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// 移动控制器\n\t\n\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 25, "start_line_no": 0, "end_line_no": 50, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_5-55", "title": "elevator-PRG\\PLC_PRG.st", "text": "\tDoorClosed: BOOL;\n\tEmergencyStop: BOOL;\n\n\t// 输出信号\n\tOpenDoor: BOOL := FALSE;\n\tCloseDoor: BOOL := FALSE;\n\n\t// 内部变量\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// 使用重构后的功能块\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// 门控制器\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// 移动控制器\n\t\n\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 5, "start_line_no": 5, "end_line_no": 55, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_10-60", "title": "elevator-PRG\\PLC_PRG.st", "text": "\tCloseDoor: BOOL := FALSE;\n\n\t// 内部变量\n\tTargetFloors: ARRAY[0..3] OF BOOL := [FALSE, FALSE, FALSE, FALSE];\n\tCurrentFloor: INT := 0;\n\t\n\t// 使用重构后的功能块\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// 门控制器\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// 移动控制器\n\t\n\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 10, "start_line_no": 10, "end_line_no": 60, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_15-65", "title": "elevator-PRG\\PLC_PRG.st", "text": "\t\n\t// 使用重构后的功能块\n\tfbDoorController\t\t:\tFB_ElevatorDoorController;\t\t// 门控制器\n\tfbMovementController\t:\tFB_ElevatorMovement;\t\t\t// 移动控制器\n\t\n\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 15, "start_line_no": 15, "end_line_no": 65, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_20-70", "title": "elevator-PRG\\PLC_PRG.st", "text": "\t// 门开关动画\n\taniDoor0, aniDoor1, aniDoor2, aniDoor3: DINT := 0;\nEND_VAR\n\n// ========== 紧急停止处理 ==========\nIF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n// 更新输出\nOpenDoor := fbDoorController.bOpenDoor;\nCloseDoor := fbDoorController.bCloseDoor;\n\n// ========== 门动画更新 ==========\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 20, "start_line_no": 20, "end_line_no": 70, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_25-75", "title": "elevator-PRG\\PLC_PRG.st", "text": "IF EmergencyStop THEN\n\tOpenDoor := FALSE;\n\tCloseDoor := FALSE;\n\t// 复位功能块\n\tfbDoorController(bArrivedAtTarget := FALSE, bDoorClosed := DoorClosed);\n\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n// 更新输出\nOpenDoor := fbDoorController.bOpenDoor;\nCloseDoor := fbDoorController.bCloseDoor;\n\n// ========== 门动画更新 ==========\naniDoor0 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallGround,\n\tnCurrentAni := aniDoor0,\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 25, "start_line_no": 25, "end_line_no": 75, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_30-80", "title": "elevator-PRG\\PLC_PRG.st", "text": "\tfbMovementController(CurrentFloor := CurrentFloor, bDoorReady := FALSE, TargetFloors := TargetFloors);\n\tRETURN;\nEND_IF\n\n// ========== 楼层检测 ==========\nCurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n// 更新输出\nOpenDoor := fbDoorController.bOpenDoor;\nCloseDoor := fbDoorController.bCloseDoor;\n\n// ========== 门动画更新 ==========\naniDoor0 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallGround,\n\tnCurrentAni := aniDoor0,\n\tnMaxAni := 70\n);\n\naniDoor1 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 30, "start_line_no": 30, "end_line_no": 80, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_35-85", "title": "elevator-PRG\\PLC_PRG.st", "text": "CurrentFloor := F_DetectCurrentFloor(\n\tFloorSensor0 := FloorSensor0,\n\tFloorSensor1 := FloorSensor1,\n\tFloorSensor2 := FloorSensor2,\n\tFloorSensor3 := FloorSensor3,\n\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n// 更新输出\nOpenDoor := fbDoorController.bOpenDoor;\nCloseDoor := fbDoorController.bCloseDoor;\n\n// ========== 门动画更新 ==========\naniDoor0 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallGround,\n\tnCurrentAni := aniDoor0,\n\tnMaxAni := 70\n);\n\naniDoor1 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor1,\n\tnCurrentAni := aniDoor1,\n\tnMaxAni := 70\n);\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 35, "start_line_no": 35, "end_line_no": 85, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_40-90", "title": "elevator-PRG\\PLC_PRG.st", "text": "\tCurrentFloor := CurrentFloor\n);\n\n// ========== 呼叫注册 ==========\nF_RegisterCalls(\n\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n// 更新输出\nOpenDoor := fbDoorController.bOpenDoor;\nCloseDoor := fbDoorController.bCloseDoor;\n\n// ========== 门动画更新 ==========\naniDoor0 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallGround,\n\tnCurrentAni := aniDoor0,\n\tnMaxAni := 70\n);\n\naniDoor1 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor1,\n\tnCurrentAni := aniDoor1,\n\tnMaxAni := 70\n);\n\naniDoor2 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor2,\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 40, "start_line_no": 40, "end_line_no": 90, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_45-95", "title": "elevator-PRG\\PLC_PRG.st", "text": "\tCallGround := CallGround,\n\tCallFloor1 := CallFloor1,\n\tCallFloor2 := CallFloor2,\n\tCallFloor3 := CallFloor3,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n// 更新输出\nOpenDoor := fbDoorController.bOpenDoor;\nCloseDoor := fbDoorController.bCloseDoor;\n\n// ========== 门动画更新 ==========\naniDoor0 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallGround,\n\tnCurrentAni := aniDoor0,\n\tnMaxAni := 70\n);\n\naniDoor1 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor1,\n\tnCurrentAni := aniDoor1,\n\tnMaxAni := 70\n);\n\naniDoor2 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor2,\n\tnCurrentAni := aniDoor2,\n\tnMaxAni := 70\n);\n\naniDoor3 := F_UpdateDoorAnimation(\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 45, "start_line_no": 45, "end_line_no": 95, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_50-100", "title": "elevator-PRG\\PLC_PRG.st", "text": ");\n\n// ========== 电梯移动控制 ==========\nfbMovementController(\n\tCurrentFloor := CurrentFloor,\n\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n// 更新输出\nOpenDoor := fbDoorController.bOpenDoor;\nCloseDoor := fbDoorController.bCloseDoor;\n\n// ========== 门动画更新 ==========\naniDoor0 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallGround,\n\tnCurrentAni := aniDoor0,\n\tnMaxAni := 70\n);\n\naniDoor1 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor1,\n\tnCurrentAni := aniDoor1,\n\tnMaxAni := 70\n);\n\naniDoor2 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor2,\n\tnCurrentAni := aniDoor2,\n\tnMaxAni := 70\n);\n\naniDoor3 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor3,\n\tnCurrentAni := aniDoor3,\n\tnMaxAni := 70\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 50, "start_line_no": 50, "end_line_no": 100, "window_size": 50, "slice_size": 5}]}
{"_id": "elevator_PRG_PLC_PRG.st_55-103", "title": "elevator-PRG\\PLC_PRG.st", "text": "\tbDoorReady := fbDoorController.bDoorReady,\n\tTargetFloors := TargetFloors\n);\n\n// ========== 门控制 ==========\nfbDoorController(\n\tbArrivedAtTarget := fbMovementController.bArrivedAtTarget,\n\tbDoorClosed := DoorClosed\n);\n\n// 更新输出\nOpenDoor := fbDoorController.bOpenDoor;\nCloseDoor := fbDoorController.bCloseDoor;\n\n// ========== 门动画更新 ==========\naniDoor0 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallGround,\n\tnCurrentAni := aniDoor0,\n\tnMaxAni := 70\n);\n\naniDoor1 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor1,\n\tnCurrentAni := aniDoor1,\n\tnMaxAni := 70\n);\n\naniDoor2 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor2,\n\tnCurrentAni := aniDoor2,\n\tnMaxAni := 70\n);\n\naniDoor3 := F_UpdateDoorAnimation(\n\tbOpenDoor := OpenDoor,\n\tbCloseDoor := CloseDoor,\n\tbCallFloor := CallFloor3,\n\tnCurrentAni := aniDoor3,\n\tnMaxAni := 70\n);\n\n// End Program...\n", "metadata": [{"fpath_tuple": ["elevator", "PRG\\PLC_PRG.st"], "repo": "elevator", "line_no": 55, "start_line_no": 55, "end_line_no": 103, "window_size": 50, "slice_size": 5}]}
