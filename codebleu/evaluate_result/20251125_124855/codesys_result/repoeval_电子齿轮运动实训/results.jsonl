{"prompt": "FUNCTION_BLOCK FB_DualAxisPower\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t//\u8f741\u5f15\u7528\n\tAxis2\t\t\t:\tAXIS_REF;\t\t//\u8f742\u5f15\u7528\n\tbEnable\t\t\t:\tBOOL := TRUE;\t//\u4f7f\u80fd\u4fe1\u53f7\nEND_VAR\nVAR_OUTPUT\n\tbAxis1Ready\t\t:\tBOOL;\t\t\t//\u8f741\u51c6\u5907\u5c31\u7eea\n\tbAxis2Ready\t\t:\tBOOL;\t\t\t//\u8f742\u51c6\u5907\u5c31\u7eea\n\tbBothReady\t\t:\tBOOL;\t\t\t//\u4e24\u8f74\u90fd\u51c6\u5907\u5c31\u7eea\n\tbError\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\nEND_VAR", "reference": "FUNCTION_BLOCK FB_DualAxisPower\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t//\u8f741\u5f15\u7528\n\tAxis2\t\t\t:\tAXIS_REF;\t\t//\u8f742\u5f15\u7528\n\tbEnable\t\t\t:\tBOOL := TRUE;\t//\u4f7f\u80fd\u4fe1\u53f7\nEND_VAR\nVAR_OUTPUT\n\tbAxis1Ready\t\t:\tBOOL;\t\t\t//\u8f741\u51c6\u5907\u5c31\u7eea\n\tbAxis2Ready\t\t:\tBOOL;\t\t\t//\u8f742\u51c6\u5907\u5c31\u7eea\n\tbBothReady\t\t:\tBOOL;\t\t\t//\u4e24\u8f74\u90fd\u51c6\u5907\u5c31\u7eea\n\tbError\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\nEND_VAR\nVAR\n\tfbPower1\t\t:\tMC_Power;\t\t//\u8f741\u7535\u6e90\u63a7\u5236\n\tfbPower2\t\t:\tMC_Power;\t\t//\u8f742\u7535\u6e90\u63a7\u5236\nEND_VAR\n\n// \u6267\u884c\u8f741\u7535\u6e90\u63a7\u5236\nfbPower1(\n\tAxis := Axis1,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n// \u6267\u884c\u8f742\u7535\u6e90\u63a7\u5236\nfbPower2(\n\tAxis := Axis2,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n// \u66f4\u65b0\u8f93\u51fa\u72b6\u6001\nbAxis1Ready := fbPower1.Status;\nbAxis2Ready := fbPower2.Status;\nbBothReady := fbPower1.Status AND fbPower2.Status;\nbError := fbPower1.Error OR fbPower2.Error;", "docs": [{"text": "FUNCTION_BLOCK FB_DualAxisPower\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t//\u8f741\u5f15\u7528\n\tAxis2\t\t\t:\tAXIS_REF;\t\t//\u8f742\u5f15\u7528\n\tbEnable\t\t\t:\tBOOL := TRUE;\t//\u4f7f\u80fd\u4fe1\u53f7\nEND_VAR\nVAR_OUTPUT\n\tbAxis1Ready\t\t:\tBOOL;\t\t\t//\u8f741\u51c6\u5907\u5c31\u7eea\n\tbAxis2Ready\t\t:\tBOOL;\t\t\t//\u8f742\u51c6\u5907\u5c31\u7eea\n\tbBothReady\t\t:\tBOOL;\t\t\t//\u4e24\u8f74\u90fd\u51c6\u5907\u5c31\u7eea\n\tbError\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\nEND_VAR\nVAR\n\tfbPower1\t\t:\tMC_Power;\t\t//\u8f741\u7535\u6e90\u63a7\u5236\n\tfbPower2\t\t:\tMC_Power;\t\t//\u8f742\u7535\u6e90\u63a7\u5236\nEND_VAR\n\n// \u6267\u884c\u8f741\u7535\u6e90\u63a7\u5236\nfbPower1(\n\tAxis := Axis1,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_DualAxisPower.st"}, {"text": "FUNCTION_BLOCK FB_DualAxisPower\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t//\u8f741\u5f15\u7528\n\tAxis2\t\t\t:\tAXIS_REF;\t\t//\u8f742\u5f15\u7528\n\tbEnable\t\t\t:\tBOOL := TRUE;\t//\u4f7f\u80fd\u4fe1\u53f7\nEND_VAR\nVAR_OUTPUT\n\tbAxis1Ready\t\t:\tBOOL;\t\t\t//\u8f741\u51c6\u5907\u5c31\u7eea\n\tbAxis2Ready\t\t:\tBOOL;\t\t\t//\u8f742\u51c6\u5907\u5c31\u7eea\n\tbBothReady\t\t:\tBOOL;\t\t\t//\u4e24\u8f74\u90fd\u51c6\u5907\u5c31\u7eea\n\tbError\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\nEND_VAR\nVAR\n\tfbPower1\t\t:\tMC_Power;\t\t//\u8f741\u7535\u6e90\u63a7\u5236\n\tfbPower2\t\t:\tMC_Power;\t\t//\u8f742\u7535\u6e90\u63a7\u5236\nEND_VAR\n\n// \u6267\u884c\u8f741\u7535\u6e90\u63a7\u5236\nfbPower1(\n\tAxis := Axis1,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n// \u6267\u884c\u8f742\u7535\u6e90\u63a7\u5236\nfbPower2(\n\tAxis := Axis2,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_DualAxisPower.st"}, {"text": "FUNCTION_BLOCK FB_DualAxisPower\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t//\u8f741\u5f15\u7528\n\tAxis2\t\t\t:\tAXIS_REF;\t\t//\u8f742\u5f15\u7528\n\tbEnable\t\t\t:\tBOOL := TRUE;\t//\u4f7f\u80fd\u4fe1\u53f7\nEND_VAR\nVAR_OUTPUT\n\tbAxis1Ready\t\t:\tBOOL;\t\t\t//\u8f741\u51c6\u5907\u5c31\u7eea\n\tbAxis2Ready\t\t:\tBOOL;\t\t\t//\u8f742\u51c6\u5907\u5c31\u7eea\n\tbBothReady\t\t:\tBOOL;\t\t\t//\u4e24\u8f74\u90fd\u51c6\u5907\u5c31\u7eea\n\tbError\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\nEND_VAR\nVAR\n\tfbPower1\t\t:\tMC_Power;\t\t//\u8f741\u7535\u6e90\u63a7\u5236\n\tfbPower2\t\t:\tMC_Power;\t\t//\u8f742\u7535\u6e90\u63a7\u5236\nEND_VAR\n\n// \u6267\u884c\u8f741\u7535\u6e90\u63a7\u5236\nfbPower1(\n\tAxis := Axis1,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n// \u6267\u884c\u8f742\u7535\u6e90\u63a7\u5236\nfbPower2(\n\tAxis := Axis2,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n// \u66f4\u65b0\u8f93\u51fa\u72b6\u6001\nbAxis1Ready := fbPower1.Status;\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_DualAxisPower.st"}, {"text": "FUNCTION_BLOCK FB_DualAxisPower\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t//\u8f741\u5f15\u7528\n\tAxis2\t\t\t:\tAXIS_REF;\t\t//\u8f742\u5f15\u7528\n\tbEnable\t\t\t:\tBOOL := TRUE;\t//\u4f7f\u80fd\u4fe1\u53f7\nEND_VAR\nVAR_OUTPUT\n\tbAxis1Ready\t\t:\tBOOL;\t\t\t//\u8f741\u51c6\u5907\u5c31\u7eea\n\tbAxis2Ready\t\t:\tBOOL;\t\t\t//\u8f742\u51c6\u5907\u5c31\u7eea\n\tbBothReady\t\t:\tBOOL;\t\t\t//\u4e24\u8f74\u90fd\u51c6\u5907\u5c31\u7eea\n\tbError\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\nEND_VAR\nVAR\n\tfbPower1\t\t:\tMC_Power;\t\t//\u8f741\u7535\u6e90\u63a7\u5236\n\tfbPower2\t\t:\tMC_Power;\t\t//\u8f742\u7535\u6e90\u63a7\u5236\nEND_VAR\n\n// \u6267\u884c\u8f741\u7535\u6e90\u63a7\u5236\nfbPower1(\n\tAxis := Axis1,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n// \u6267\u884c\u8f742\u7535\u6e90\u63a7\u5236\nfbPower2(\n\tAxis := Axis2,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n// \u66f4\u65b0\u8f93\u51fa\u72b6\u6001\nbAxis1Ready := fbPower1.Status;\nbAxis2Ready := fbPower2.Status;\nbBothReady := fbPower1.Status AND fbPower2.Status;\nbError := fbPower1.Error OR fbPower2.Error;\n\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_DualAxisPower.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n\t\tbRunning := FALSE;\n\t\tbReady := FALSE;\n\t\tIF fbPowerMgr.bBothReady THEN\n\t\t\tnState := 1;\n\t\t\tbReady := TRUE;\n\t\tEND_IF\n\t\t\n\t1: (* \u7b49\u5f85\u542f\u52a8\u4fe1\u53f7 *)\n\t\tbRunning := FALSE;\n\t\tbReady := TRUE;\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n\t\tbRunning := FALSE;\n\t\tbReady := FALSE;\n\t\tIF fbPowerMgr.bBothReady THEN\n\t\t\tnState := 1;\n\t\t\tbReady := TRUE;\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}], "metadata": {"task_id": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad/0", "ground_truth": "FUNCTION_BLOCK FB_DualAxisPower\nVAR_INPUT\n\tAxis1\t\t\t:\tAXIS_REF;\t\t//\u8f741\u5f15\u7528\n\tAxis2\t\t\t:\tAXIS_REF;\t\t//\u8f742\u5f15\u7528\n\tbEnable\t\t\t:\tBOOL := TRUE;\t//\u4f7f\u80fd\u4fe1\u53f7\nEND_VAR\nVAR_OUTPUT\n\tbAxis1Ready\t\t:\tBOOL;\t\t\t//\u8f741\u51c6\u5907\u5c31\u7eea\n\tbAxis2Ready\t\t:\tBOOL;\t\t\t//\u8f742\u51c6\u5907\u5c31\u7eea\n\tbBothReady\t\t:\tBOOL;\t\t\t//\u4e24\u8f74\u90fd\u51c6\u5907\u5c31\u7eea\n\tbError\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\nEND_VAR\nVAR\n\tfbPower1\t\t:\tMC_Power;\t\t//\u8f741\u7535\u6e90\u63a7\u5236\n\tfbPower2\t\t:\tMC_Power;\t\t//\u8f742\u7535\u6e90\u63a7\u5236\nEND_VAR\n\n// \u6267\u884c\u8f741\u7535\u6e90\u63a7\u5236\nfbPower1(\n\tAxis := Axis1,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n// \u6267\u884c\u8f742\u7535\u6e90\u63a7\u5236\nfbPower2(\n\tAxis := Axis2,\n\tEnable := bEnable,\n\tbDriveStart := TRUE,\n\tbRegulatorOn := TRUE\n);\n\n// \u66f4\u65b0\u8f93\u51fa\u72b6\u6001\nbAxis1Ready := fbPower1.Status;\nbAxis2Ready := fbPower2.Status;\nbBothReady := fbPower1.Status AND fbPower2.Status;\nbError := fbPower1.Error OR fbPower2.Error;", "fpath_tuple": ["FUN", "FB_DualAxisPower.st"], "context_start_lineno": 0, "lineno": 13, "function_name": "FB_DualAxisPower"}}
{"prompt": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR", "reference": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR\nVAR\n\tfbGearIn\t\t\t:\tMC_GearIn;\t\t//\u9f7f\u8f6e\u8026\u5408\u529f\u80fd\u5757\n\tfbGearOut\t\t\t:\tMC_GearOut;\t\t//\u9f7f\u8f6e\u89e3\u8026\u529f\u80fd\u5757\n\tbLastCouple\t\t\t:\tBOOL;\t\t\t//\u4e0a\u6b21\u8026\u5408\u72b6\u6001\n\tbCoupleRising\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0a\u5347\u6cbf\n\tbCoupleFalling\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0b\u964d\u6cbf\nEND_VAR\n\n// \u68c0\u6d4b\u8026\u5408\u4fe1\u53f7\u7684\u8fb9\u6cbf\nbCoupleRising := bCouple AND NOT bLastCouple;\nbCoupleFalling := NOT bCouple AND bLastCouple;\nbLastCouple := bCouple;\n\n// \u9f7f\u8f6e\u8026\u5408\u63a7\u5236\nIF bCouple THEN\n\t// \u6267\u884c\u8026\u5408\n\tfbGearIn(\n\t\tExecute := TRUE,\n\t\tMaster := Master,\n\t\tSlave := Slave,\n\t\tRatioNumerator := nRatioNumerator,\n\t\tRatioDenominator := nRatioDenominator,\n\t\tAcceleration := rAcceleration,\n\t\tDeceleration := rDeceleration\n\t);\n\t\n\tbInGear := fbGearIn.InGear;\n\tbCouplingDone := fbGearIn.InGear;\n\tbDecouplingDone := FALSE;\n\tbError := fbGearIn.Error;\n\tnErrorID := fbGearIn.ErrorID;\nELSE\n\t// \u6267\u884c\u89e3\u8026\n\tfbGearIn(Execute := FALSE, Master := Master, Slave := Slave);\n\t\n\tfbGearOut(\n\t\tExecute := TRUE,\n\t\tSlave := Slave\n\t);\n\t\n\tbInGear := FALSE;\n\tbCouplingDone := FALSE;\n\tbDecouplingDone := fbGearOut.Done;\n\tbError := fbGearOut.Error;\n\tnErrorID := fbGearOut.ErrorID;\n\t\n\t// \u89e3\u8026\u5b8c\u6210\u540e\u590d\u4f4d\n\tIF fbGearOut.Done THEN\n\t\tfbGearOut(Execute := FALSE, Slave := Slave);\n\tEND_IF\nEND_IF", "docs": [{"text": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR\nVAR\n\tfbGearIn\t\t\t:\tMC_GearIn;\t\t//\u9f7f\u8f6e\u8026\u5408\u529f\u80fd\u5757\n\tfbGearOut\t\t\t:\tMC_GearOut;\t\t//\u9f7f\u8f6e\u89e3\u8026\u529f\u80fd\u5757\n\tbLastCouple\t\t\t:\tBOOL;\t\t\t//\u4e0a\u6b21\u8026\u5408\u72b6\u6001\n\tbCoupleRising\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0a\u5347\u6cbf\n\tbCoupleFalling\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0b\u964d\u6cbf\nEND_VAR\n\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearCoupling.st"}, {"text": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR\nVAR\n\tfbGearIn\t\t\t:\tMC_GearIn;\t\t//\u9f7f\u8f6e\u8026\u5408\u529f\u80fd\u5757\n\tfbGearOut\t\t\t:\tMC_GearOut;\t\t//\u9f7f\u8f6e\u89e3\u8026\u529f\u80fd\u5757\n\tbLastCouple\t\t\t:\tBOOL;\t\t\t//\u4e0a\u6b21\u8026\u5408\u72b6\u6001\n\tbCoupleRising\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0a\u5347\u6cbf\n\tbCoupleFalling\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0b\u964d\u6cbf\nEND_VAR\n\n// \u68c0\u6d4b\u8026\u5408\u4fe1\u53f7\u7684\u8fb9\u6cbf\nbCoupleRising := bCouple AND NOT bLastCouple;\nbCoupleFalling := NOT bCouple AND bLastCouple;\nbLastCouple := bCouple;\n\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearCoupling.st"}, {"text": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR\nVAR\n\tfbGearIn\t\t\t:\tMC_GearIn;\t\t//\u9f7f\u8f6e\u8026\u5408\u529f\u80fd\u5757\n\tfbGearOut\t\t\t:\tMC_GearOut;\t\t//\u9f7f\u8f6e\u89e3\u8026\u529f\u80fd\u5757\n\tbLastCouple\t\t\t:\tBOOL;\t\t\t//\u4e0a\u6b21\u8026\u5408\u72b6\u6001\n\tbCoupleRising\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0a\u5347\u6cbf\n\tbCoupleFalling\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0b\u964d\u6cbf\nEND_VAR\n\n// \u68c0\u6d4b\u8026\u5408\u4fe1\u53f7\u7684\u8fb9\u6cbf\nbCoupleRising := bCouple AND NOT bLastCouple;\nbCoupleFalling := NOT bCouple AND bLastCouple;\nbLastCouple := bCouple;\n\n// \u9f7f\u8f6e\u8026\u5408\u63a7\u5236\nIF bCouple THEN\n\t// \u6267\u884c\u8026\u5408\n\tfbGearIn(\n\t\tExecute := TRUE,\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearCoupling.st"}, {"text": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR\nVAR\n\tfbGearIn\t\t\t:\tMC_GearIn;\t\t//\u9f7f\u8f6e\u8026\u5408\u529f\u80fd\u5757\n\tfbGearOut\t\t\t:\tMC_GearOut;\t\t//\u9f7f\u8f6e\u89e3\u8026\u529f\u80fd\u5757\n\tbLastCouple\t\t\t:\tBOOL;\t\t\t//\u4e0a\u6b21\u8026\u5408\u72b6\u6001\n\tbCoupleRising\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0a\u5347\u6cbf\n\tbCoupleFalling\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0b\u964d\u6cbf\nEND_VAR\n\n// \u68c0\u6d4b\u8026\u5408\u4fe1\u53f7\u7684\u8fb9\u6cbf\nbCoupleRising := bCouple AND NOT bLastCouple;\nbCoupleFalling := NOT bCouple AND bLastCouple;\nbLastCouple := bCouple;\n\n// \u9f7f\u8f6e\u8026\u5408\u63a7\u5236\nIF bCouple THEN\n\t// \u6267\u884c\u8026\u5408\n\tfbGearIn(\n\t\tExecute := TRUE,\n\t\tMaster := Master,\n\t\tSlave := Slave,\n\t\tRatioNumerator := nRatioNumerator,\n\t\tRatioDenominator := nRatioDenominator,\n\t\tAcceleration := rAcceleration,\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearCoupling.st"}, {"text": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR\nVAR\n\tfbGearIn\t\t\t:\tMC_GearIn;\t\t//\u9f7f\u8f6e\u8026\u5408\u529f\u80fd\u5757\n\tfbGearOut\t\t\t:\tMC_GearOut;\t\t//\u9f7f\u8f6e\u89e3\u8026\u529f\u80fd\u5757\n\tbLastCouple\t\t\t:\tBOOL;\t\t\t//\u4e0a\u6b21\u8026\u5408\u72b6\u6001\n\tbCoupleRising\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0a\u5347\u6cbf\n\tbCoupleFalling\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0b\u964d\u6cbf\nEND_VAR\n\n// \u68c0\u6d4b\u8026\u5408\u4fe1\u53f7\u7684\u8fb9\u6cbf\nbCoupleRising := bCouple AND NOT bLastCouple;\nbCoupleFalling := NOT bCouple AND bLastCouple;\nbLastCouple := bCouple;\n\n// \u9f7f\u8f6e\u8026\u5408\u63a7\u5236\nIF bCouple THEN\n\t// \u6267\u884c\u8026\u5408\n\tfbGearIn(\n\t\tExecute := TRUE,\n\t\tMaster := Master,\n\t\tSlave := Slave,\n\t\tRatioNumerator := nRatioNumerator,\n\t\tRatioDenominator := nRatioDenominator,\n\t\tAcceleration := rAcceleration,\n\t\tDeceleration := rDeceleration\n\t);\n\t\n\tbInGear := fbGearIn.InGear;\n\tbCouplingDone := fbGearIn.InGear;\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearCoupling.st"}, {"text": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR\nVAR\n\tfbGearIn\t\t\t:\tMC_GearIn;\t\t//\u9f7f\u8f6e\u8026\u5408\u529f\u80fd\u5757\n\tfbGearOut\t\t\t:\tMC_GearOut;\t\t//\u9f7f\u8f6e\u89e3\u8026\u529f\u80fd\u5757\n\tbLastCouple\t\t\t:\tBOOL;\t\t\t//\u4e0a\u6b21\u8026\u5408\u72b6\u6001\n\tbCoupleRising\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0a\u5347\u6cbf\n\tbCoupleFalling\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0b\u964d\u6cbf\nEND_VAR\n\n// \u68c0\u6d4b\u8026\u5408\u4fe1\u53f7\u7684\u8fb9\u6cbf\nbCoupleRising := bCouple AND NOT bLastCouple;\nbCoupleFalling := NOT bCouple AND bLastCouple;\nbLastCouple := bCouple;\n\n// \u9f7f\u8f6e\u8026\u5408\u63a7\u5236\nIF bCouple THEN\n\t// \u6267\u884c\u8026\u5408\n\tfbGearIn(\n\t\tExecute := TRUE,\n\t\tMaster := Master,\n\t\tSlave := Slave,\n\t\tRatioNumerator := nRatioNumerator,\n\t\tRatioDenominator := nRatioDenominator,\n\t\tAcceleration := rAcceleration,\n\t\tDeceleration := rDeceleration\n\t);\n\t\n\tbInGear := fbGearIn.InGear;\n\tbCouplingDone := fbGearIn.InGear;\n\tbDecouplingDone := FALSE;\n\tbError := fbGearIn.Error;\n\tnErrorID := fbGearIn.ErrorID;\nELSE\n\t// \u6267\u884c\u89e3\u8026\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearCoupling.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n\t\tbRunning := FALSE;\n\t\tbReady := FALSE;\n\t\tIF fbPowerMgr.bBothReady THEN\n\t\t\tnState := 1;\n\t\t\tbReady := TRUE;\n\t\tEND_IF\n\t\t\n\t1: (* \u7b49\u5f85\u542f\u52a8\u4fe1\u53f7 *)\n\t\tbRunning := FALSE;\n\t\tbReady := TRUE;\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n\t\tbRunning := FALSE;\n\t\tbReady := FALSE;\n\t\tIF fbPowerMgr.bBothReady THEN\n\t\t\tnState := 1;\n\t\t\tbReady := TRUE;\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}], "metadata": {"task_id": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad/1", "ground_truth": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR\nVAR\n\tfbGearIn\t\t\t:\tMC_GearIn;\t\t//\u9f7f\u8f6e\u8026\u5408\u529f\u80fd\u5757\n\tfbGearOut\t\t\t:\tMC_GearOut;\t\t//\u9f7f\u8f6e\u89e3\u8026\u529f\u80fd\u5757\n\tbLastCouple\t\t\t:\tBOOL;\t\t\t//\u4e0a\u6b21\u8026\u5408\u72b6\u6001\n\tbCoupleRising\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0a\u5347\u6cbf\n\tbCoupleFalling\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0b\u964d\u6cbf\nEND_VAR\n\n// \u68c0\u6d4b\u8026\u5408\u4fe1\u53f7\u7684\u8fb9\u6cbf\nbCoupleRising := bCouple AND NOT bLastCouple;\nbCoupleFalling := NOT bCouple AND bLastCouple;\nbLastCouple := bCouple;\n\n// \u9f7f\u8f6e\u8026\u5408\u63a7\u5236\nIF bCouple THEN\n\t// \u6267\u884c\u8026\u5408\n\tfbGearIn(\n\t\tExecute := TRUE,\n\t\tMaster := Master,\n\t\tSlave := Slave,\n\t\tRatioNumerator := nRatioNumerator,\n\t\tRatioDenominator := nRatioDenominator,\n\t\tAcceleration := rAcceleration,\n\t\tDeceleration := rDeceleration\n\t);\n\t\n\tbInGear := fbGearIn.InGear;\n\tbCouplingDone := fbGearIn.InGear;\n\tbDecouplingDone := FALSE;\n\tbError := fbGearIn.Error;\n\tnErrorID := fbGearIn.ErrorID;\nELSE\n\t// \u6267\u884c\u89e3\u8026\n\tfbGearIn(Execute := FALSE, Master := Master, Slave := Slave);\n\t\n\tfbGearOut(\n\t\tExecute := TRUE,\n\t\tSlave := Slave\n\t);\n\t\n\tbInGear := FALSE;\n\tbCouplingDone := FALSE;\n\tbDecouplingDone := fbGearOut.Done;\n\tbError := fbGearOut.Error;\n\tnErrorID := fbGearOut.ErrorID;\n\t\n\t// \u89e3\u8026\u5b8c\u6210\u540e\u590d\u4f4d\n\tIF fbGearOut.Done THEN\n\t\tfbGearOut(Execute := FALSE, Slave := Slave);\n\tEND_IF\nEND_IF", "fpath_tuple": ["FUN", "FB_GearCoupling.st"], "context_start_lineno": 0, "lineno": 18, "function_name": "FB_GearCoupling"}}
{"prompt": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR", "reference": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n\t\tbRunning := FALSE;\n\t\tbReady := FALSE;\n\t\tIF fbPowerMgr.bBothReady THEN\n\t\t\tnState := 1;\n\t\t\tbReady := TRUE;\n\t\tEND_IF\n\t\t\n\t1: (* \u7b49\u5f85\u542f\u52a8\u4fe1\u53f7 *)\n\t\tbRunning := FALSE;\n\t\tbReady := TRUE;\n\t\tfbStartRtrig(CLK := bStart);\n\t\tIF fbStartRtrig.Q THEN\n\t\t\tnState := 2;\n\t\t\t// \u521d\u59cb\u5316\u590d\u4f4d\n\t\t\tfbGearCtrl.bCouple := FALSE;\n\t\t\tfbMoveVel(Execute := FALSE, Axis := MasterAxis);\n\t\tEND_IF\n\t\t\n\t2: (* \u6267\u884c\u9f7f\u8f6e\u8026\u5408\u548c\u8fd0\u52a8 *)\n\t\tbRunning := TRUE;\n\t\tbReady := FALSE;\n\t\t\n\t\t// \u542f\u52a8\u9f7f\u8f6e\u8026\u5408\n\t\tfbGearCtrl(\n\t\t\tMaster := MasterAxis,\n\t\t\tSlave := SlaveAxis,\n\t\t\tbCouple := TRUE,\n\t\t\tnRatioNumerator := nRatioNumerator,\n\t\t\tnRatioDenominator := nRatioDenominator,\n\t\t\trAcceleration := rAcceleration,\n\t\t\trDeceleration := rDeceleration\n\t\t);\n\t\t\n\t\t// \u4e3b\u8f74\u6267\u884c\u901f\u5ea6\u8fd0\u52a8\n\t\tfbMoveVel(\n\t\t\tExecute := fbGearCtrl.bInGear,\n\t\t\tDirection := nDirection,\n\t\t\tVelocity := rVelocity,\n\t\t\tAcceleration := rAcceleration,\n\t\t\tDeceleration := rDeceleration,\n\t\t\tAxis := MasterAxis\n\t\t);\n\t\t\n\t\t// \u68c0\u6d4b\u505c\u6b62\u4fe1\u53f7\n\t\tfbStopRtrig(CLK := bStop);\n\t\tIF fbStopRtrig.Q THEN\n\t\t\tnState := 3;\n\t\t\tfbMoveVel(Execute := FALSE, Axis := MasterAxis);\n\t\t\tfbHaltMaster(Axis := MasterAxis, Execute := FALSE);\n\t\tEND_IF\n\t\t\n\t3: (* \u505c\u6b62\u4e3b\u8f74 *)\n\t\tbRunning := FALSE;\n\t\t\n\t\t// \u89e3\u9664\u9f7f\u8f6e\u8026\u5408\n\t\tfbGearCtrl(\n\t\t\tMaster := MasterAxis,\n\t\t\tSlave := SlaveAxis,\n\t\t\tbCouple := FALSE\n\t\t);\n\t\t\n\t\t// \u505c\u6b62\u4e3b\u8f74\n\t\tfbHaltMaster(\n\t\t\tAxis := MasterAxis,\n\t\t\tExecute := TRUE,\n\t\t\tDeceleration := rDeceleration\n\t\t);\n\t\t\n\t\tIF fbHaltMaster.Done THEN\n\t\t\tfbHaltMaster(Axis := MasterAxis, Execute := FALSE);\n\t\t\tfbHaltSlave(Axis := SlaveAxis, Execute := FALSE);\n\t\t\tnState := 4;\n\t\tEND_IF\n\t\t\n\t4: (* \u505c\u6b62\u4ece\u8f74 *)\n\t\t// \u7b49\u5f85\u89e3\u8026\u5b8c\u6210\n\t\tIF fbGearCtrl.bDecouplingDone THEN\n\t\t\tfbHaltSlave(\n\t\t\t\tAxis := SlaveAxis,\n\t\t\t\tExecute := TRUE,\n\t\t\t\tDeceleration := rDeceleration\n\t\t\t);\n\t\t\t\n\t\t\tIF fbHaltSlave.Done THEN\n\t\t\t\tfbHaltSlave(Axis := SlaveAxis, Execute := FALSE);\n\t\t\t\tnState := 1;  // \u8fd4\u56de\u7b49\u5f85\u542f\u52a8\u72b6\u6001\n\t\t\tEND_IF\n\t\tEND_IF\nEND_CASE\n\n// \u66f4\u65b0\u8f93\u51fa\nnCurrentState := nState;\nbError := fbPowerMgr.bError OR fbGearCtrl.bError OR fbMoveVel.Error OR fbHaltMaster.Error OR fbHaltSlave.Error;", "docs": [{"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n\t\tbRunning := FALSE;\n\t\tbReady := FALSE;\n\t\tIF fbPowerMgr.bBothReady THEN\n\t\t\tnState := 1;\n\t\t\tbReady := TRUE;\n\t\tEND_IF\n\t\t\n\t1: (* \u7b49\u5f85\u542f\u52a8\u4fe1\u53f7 *)\n\t\tbRunning := FALSE;\n\t\tbReady := TRUE;\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n\t\tbRunning := FALSE;\n\t\tbReady := FALSE;\n\t\tIF fbPowerMgr.bBothReady THEN\n\t\t\tnState := 1;\n\t\t\tbReady := TRUE;\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "\t\t\tAxis := MasterAxis\n\t\t);\n\t\t\n\t\t// \u68c0\u6d4b\u505c\u6b62\u4fe1\u53f7\n\t\tfbStopRtrig(CLK := bStop);\n\t\tIF fbStopRtrig.Q THEN\n\t\t\tnState := 3;\n\t\t\tfbMoveVel(Execute := FALSE, Axis := MasterAxis);\n\t\t\tfbHaltMaster(Axis := MasterAxis, Execute := FALSE);\n\t\tEND_IF\n\t\t\n\t3: (* \u505c\u6b62\u4e3b\u8f74 *)\n\t\tbRunning := FALSE;\n\t\t\n\t\t// \u89e3\u9664\u9f7f\u8f6e\u8026\u5408\n\t\tfbGearCtrl(\n\t\t\tMaster := MasterAxis,\n\t\t\tSlave := SlaveAxis,\n\t\t\tbCouple := FALSE\n\t\t);\n\t\t\n\t\t// \u505c\u6b62\u4e3b\u8f74\n\t\tfbHaltMaster(\n\t\t\tAxis := MasterAxis,\n\t\t\tExecute := TRUE,\n\t\t\tDeceleration := rDeceleration\n\t\t);\n\t\t\n\t\tIF fbHaltMaster.Done THEN\n\t\t\tfbHaltMaster(Axis := MasterAxis, Execute := FALSE);\n\t\t\tfbHaltSlave(Axis := SlaveAxis, Execute := FALSE);\n\t\t\tnState := 4;\n\t\tEND_IF\n\t\t\n\t4: (* \u505c\u6b62\u4ece\u8f74 *)\n\t\t// \u7b49\u5f85\u89e3\u8026\u5b8c\u6210\n\t\tIF fbGearCtrl.bDecouplingDone THEN\n\t\t\tfbHaltSlave(\n\t\t\t\tAxis := SlaveAxis,\n\t\t\t\tExecute := TRUE,\n\t\t\t\tDeceleration := rDeceleration\n\t\t\t);\n\t\t\t\n\t\t\tIF fbHaltSlave.Done THEN\n\t\t\t\tfbHaltSlave(Axis := SlaveAxis, Execute := FALSE);\n\t\t\t\tnState := 1;  // \u8fd4\u56de\u7b49\u5f85\u542f\u52a8\u72b6\u6001\n\t\t\tEND_IF\n\t\tEND_IF\nEND_CASE\n\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "\t\t\tSlave := SlaveAxis,\n\t\t\tbCouple := TRUE,\n\t\t\tnRatioNumerator := nRatioNumerator,\n\t\t\tnRatioDenominator := nRatioDenominator,\n\t\t\trAcceleration := rAcceleration,\n\t\t\trDeceleration := rDeceleration\n\t\t);\n\t\t\n\t\t// \u4e3b\u8f74\u6267\u884c\u901f\u5ea6\u8fd0\u52a8\n\t\tfbMoveVel(\n\t\t\tExecute := fbGearCtrl.bInGear,\n\t\t\tDirection := nDirection,\n\t\t\tVelocity := rVelocity,\n\t\t\tAcceleration := rAcceleration,\n\t\t\tDeceleration := rDeceleration,\n\t\t\tAxis := MasterAxis\n\t\t);\n\t\t\n\t\t// \u68c0\u6d4b\u505c\u6b62\u4fe1\u53f7\n\t\tfbStopRtrig(CLK := bStop);\n\t\tIF fbStopRtrig.Q THEN\n\t\t\tnState := 3;\n\t\t\tfbMoveVel(Execute := FALSE, Axis := MasterAxis);\n\t\t\tfbHaltMaster(Axis := MasterAxis, Execute := FALSE);\n\t\tEND_IF\n\t\t\n\t3: (* \u505c\u6b62\u4e3b\u8f74 *)\n\t\tbRunning := FALSE;\n\t\t\n\t\t// \u89e3\u9664\u9f7f\u8f6e\u8026\u5408\n\t\tfbGearCtrl(\n\t\t\tMaster := MasterAxis,\n\t\t\tSlave := SlaveAxis,\n\t\t\tbCouple := FALSE\n\t\t);\n\t\t\n\t\t// \u505c\u6b62\u4e3b\u8f74\n\t\tfbHaltMaster(\n\t\t\tAxis := MasterAxis,\n\t\t\tExecute := TRUE,\n\t\t\tDeceleration := rDeceleration\n\t\t);\n\t\t\n\t\tIF fbHaltMaster.Done THEN\n\t\t\tfbHaltMaster(Axis := MasterAxis, Execute := FALSE);\n\t\t\tfbHaltSlave(Axis := SlaveAxis, Execute := FALSE);\n\t\t\tnState := 4;\n\t\tEND_IF\n\t\t\n\t4: (* \u505c\u6b62\u4ece\u8f74 *)\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}, {"text": "FUNCTION_BLOCK FB_GearCoupling\nVAR_INPUT\n\tMaster\t\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlave\t\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbCouple\t\t\t\t:\tBOOL;\t\t\t//TRUE=\u8026\u5408\uff0cFALSE=\u89e3\u8026\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbInGear\t\t\t\t:\tBOOL;\t\t\t//\u8026\u5408\u72b6\u6001\n\tbCouplingDone\t\t:\tBOOL;\t\t\t//\u8026\u5408\u5b8c\u6210\n\tbDecouplingDone\t\t:\tBOOL;\t\t\t//\u89e3\u8026\u5b8c\u6210\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnErrorID\t\t\t:\tDWORD;\t\t\t//\u9519\u8bef\u4ee3\u7801\nEND_VAR\nVAR\n\tfbGearIn\t\t\t:\tMC_GearIn;\t\t//\u9f7f\u8f6e\u8026\u5408\u529f\u80fd\u5757\n\tfbGearOut\t\t\t:\tMC_GearOut;\t\t//\u9f7f\u8f6e\u89e3\u8026\u529f\u80fd\u5757\n\tbLastCouple\t\t\t:\tBOOL;\t\t\t//\u4e0a\u6b21\u8026\u5408\u72b6\u6001\n\tbCoupleRising\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0a\u5347\u6cbf\n\tbCoupleFalling\t\t:\tBOOL;\t\t\t//\u8026\u5408\u4e0b\u964d\u6cbf\nEND_VAR\n\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearCoupling.st"}, {"text": "\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n\t\tbRunning := FALSE;\n\t\tbReady := FALSE;\n\t\tIF fbPowerMgr.bBothReady THEN\n\t\t\tnState := 1;\n\t\t\tbReady := TRUE;\n\t\tEND_IF\n\t\t\n\t1: (* \u7b49\u5f85\u542f\u52a8\u4fe1\u53f7 *)\n\t\tbRunning := FALSE;\n\t\tbReady := TRUE;\n\t\tfbStartRtrig(CLK := bStart);\n\t\tIF fbStartRtrig.Q THEN\n\t\t\tnState := 2;\n\t\t\t// \u521d\u59cb\u5316\u590d\u4f4d\n\t\t\tfbGearCtrl.bCouple := FALSE;\n\t\t\tfbMoveVel(Execute := FALSE, Axis := MasterAxis);\n\t\tEND_IF\n\t\t\n\t2: (* \u6267\u884c\u9f7f\u8f6e\u8026\u5408\u548c\u8fd0\u52a8 *)\n\t\tbRunning := TRUE;\n", "title": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad-FUN\\FB_GearMotionControl.st"}], "metadata": {"task_id": "\u7535\u5b50\u9f7f\u8f6e\u8fd0\u52a8\u5b9e\u8bad/2", "ground_truth": "FUNCTION_BLOCK FB_GearMotionControl\nVAR_INPUT\n\tMasterAxis\t\t\t:\tAXIS_REF;\t\t//\u4e3b\u8f74\u5f15\u7528\n\tSlaveAxis\t\t\t:\tAXIS_REF;\t\t//\u4ece\u8f74\u5f15\u7528\n\tbStart\t\t\t\t:\tBOOL;\t\t\t//\u542f\u52a8\u4fe1\u53f7\n\tbStop\t\t\t\t:\tBOOL;\t\t\t//\u505c\u6b62\u4fe1\u53f7\n\tnRatioNumerator\t\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u5b50\n\tnRatioDenominator\t:\tINT := 1;\t\t//\u4f20\u52a8\u6bd4\u5206\u6bcd\n\tnDirection\t\t\t:\tINT := 1;\t\t//\u8fd0\u52a8\u65b9\u5411\uff081=\u6b63\u5411\uff0c-1=\u53cd\u5411\uff09\n\trVelocity\t\t\t:\tREAL := 360.0;\t//\u4e3b\u8f74\u901f\u5ea6\n\trAcceleration\t\t:\tREAL := 10000.0;//\u52a0\u901f\u5ea6\n\trDeceleration\t\t:\tREAL := 10000.0;//\u51cf\u901f\u5ea6\nEND_VAR\nVAR_OUTPUT\n\tbRunning\t\t\t:\tBOOL;\t\t\t//\u8fd0\u884c\u4e2d\n\tbReady\t\t\t\t:\tBOOL;\t\t\t//\u51c6\u5907\u5c31\u7eea\uff08\u53ef\u4ee5\u542f\u52a8\uff09\n\tbError\t\t\t\t:\tBOOL;\t\t\t//\u9519\u8bef\u6807\u5fd7\n\tnCurrentState\t\t:\tBYTE;\t\t\t//\u5f53\u524d\u72b6\u6001\nEND_VAR\nVAR\n\tfbPowerMgr\t\t\t:\tFB_DualAxisPower;\t//\u53cc\u8f74\u7535\u6e90\u7ba1\u7406\n\tfbGearCtrl\t\t\t:\tFB_GearCoupling;\t//\u9f7f\u8f6e\u8026\u5408\u63a7\u5236\n\tfbMoveVel\t\t\t:\tMC_MoveVelocity;\t//\u901f\u5ea6\u8fd0\u52a8\n\tfbHaltMaster\t\t:\tMC_Halt;\t\t\t//\u4e3b\u8f74\u505c\u6b62\n\tfbHaltSlave\t\t\t:\tMC_Halt;\t\t\t//\u4ece\u8f74\u505c\u6b62\n\tfbStartRtrig\t\t:\tR_TRIG;\t\t\t\t//\u542f\u52a8\u4e0a\u5347\u6cbf\n\tfbStopRtrig\t\t\t:\tR_TRIG;\t\t\t\t//\u505c\u6b62\u4e0a\u5347\u6cbf\n\tnState\t\t\t\t:\tBYTE;\t\t\t\t//\u5185\u90e8\u72b6\u6001\u673a\nEND_VAR\n\n// \u53cc\u8f74\u7535\u6e90\u7ba1\u7406\nfbPowerMgr(\n\tAxis1 := MasterAxis,\n\tAxis2 := SlaveAxis,\n\tbEnable := TRUE\n);\n\n// \u72b6\u6001\u673a\nCASE nState OF\n\t0: (* \u7b49\u5f85\u8f74\u51c6\u5907\u5c31\u7eea *)\n\t\tbRunning := FALSE;\n\t\tbReady := FALSE;\n\t\tIF fbPowerMgr.bBothReady THEN\n\t\t\tnState := 1;\n\t\t\tbReady := TRUE;\n\t\tEND_IF\n\t\t\n\t1: (* \u7b49\u5f85\u542f\u52a8\u4fe1\u53f7 *)\n\t\tbRunning := FALSE;\n\t\tbReady := TRUE;\n\t\tfbStartRtrig(CLK := bStart);\n\t\tIF fbStartRtrig.Q THEN\n\t\t\tnState := 2;\n\t\t\t// \u521d\u59cb\u5316\u590d\u4f4d\n\t\t\tfbGearCtrl.bCouple := FALSE;\n\t\t\tfbMoveVel(Execute := FALSE, Axis := MasterAxis);\n\t\tEND_IF\n\t\t\n\t2: (* \u6267\u884c\u9f7f\u8f6e\u8026\u5408\u548c\u8fd0\u52a8 *)\n\t\tbRunning := TRUE;\n\t\tbReady := FALSE;\n\t\t\n\t\t// \u542f\u52a8\u9f7f\u8f6e\u8026\u5408\n\t\tfbGearCtrl(\n\t\t\tMaster := MasterAxis,\n\t\t\tSlave := SlaveAxis,\n\t\t\tbCouple := TRUE,\n\t\t\tnRatioNumerator := nRatioNumerator,\n\t\t\tnRatioDenominator := nRatioDenominator,\n\t\t\trAcceleration := rAcceleration,\n\t\t\trDeceleration := rDeceleration\n\t\t);\n\t\t\n\t\t// \u4e3b\u8f74\u6267\u884c\u901f\u5ea6\u8fd0\u52a8\n\t\tfbMoveVel(\n\t\t\tExecute := fbGearCtrl.bInGear,\n\t\t\tDirection := nDirection,\n\t\t\tVelocity := rVelocity,\n\t\t\tAcceleration := rAcceleration,\n\t\t\tDeceleration := rDeceleration,\n\t\t\tAxis := MasterAxis\n\t\t);\n\t\t\n\t\t// \u68c0\u6d4b\u505c\u6b62\u4fe1\u53f7\n\t\tfbStopRtrig(CLK := bStop);\n\t\tIF fbStopRtrig.Q THEN\n\t\t\tnState := 3;\n\t\t\tfbMoveVel(Execute := FALSE, Axis := MasterAxis);\n\t\t\tfbHaltMaster(Axis := MasterAxis, Execute := FALSE);\n\t\tEND_IF\n\t\t\n\t3: (* \u505c\u6b62\u4e3b\u8f74 *)\n\t\tbRunning := FALSE;\n\t\t\n\t\t// \u89e3\u9664\u9f7f\u8f6e\u8026\u5408\n\t\tfbGearCtrl(\n\t\t\tMaster := MasterAxis,\n\t\t\tSlave := SlaveAxis,\n\t\t\tbCouple := FALSE\n\t\t);\n\t\t\n\t\t// \u505c\u6b62\u4e3b\u8f74\n\t\tfbHaltMaster(\n\t\t\tAxis := MasterAxis,\n\t\t\tExecute := TRUE,\n\t\t\tDeceleration := rDeceleration\n\t\t);\n\t\t\n\t\tIF fbHaltMaster.Done THEN\n\t\t\tfbHaltMaster(Axis := MasterAxis, Execute := FALSE);\n\t\t\tfbHaltSlave(Axis := SlaveAxis, Execute := FALSE);\n\t\t\tnState := 4;\n\t\tEND_IF\n\t\t\n\t4: (* \u505c\u6b62\u4ece\u8f74 *)\n\t\t// \u7b49\u5f85\u89e3\u8026\u5b8c\u6210\n\t\tIF fbGearCtrl.bDecouplingDone THEN\n\t\t\tfbHaltSlave(\n\t\t\t\tAxis := SlaveAxis,\n\t\t\t\tExecute := TRUE,\n\t\t\t\tDeceleration := rDeceleration\n\t\t\t);\n\t\t\t\n\t\t\tIF fbHaltSlave.Done THEN\n\t\t\t\tfbHaltSlave(Axis := SlaveAxis, Execute := FALSE);\n\t\t\t\tnState := 1;  // \u8fd4\u56de\u7b49\u5f85\u542f\u52a8\u72b6\u6001\n\t\t\tEND_IF\n\t\tEND_IF\nEND_CASE\n\n// \u66f4\u65b0\u8f93\u51fa\nnCurrentState := nState;\nbError := fbPowerMgr.bError OR fbGearCtrl.bError OR fbMoveVel.Error OR fbHaltMaster.Error OR fbHaltSlave.Error;", "fpath_tuple": ["FUN", "FB_GearMotionControl.st"], "context_start_lineno": 0, "lineno": 20, "function_name": "FB_GearMotionControl"}}
